
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<!-- "$Id: MODATTS3.html 75 2018-01-12 15:48:16Z coats $" -->
<META NAME="MSSmartTagsPreventParsing" CONTENT="TRUE">
<TITLE>MODULE MODATTS3</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFFF"
      TOPMARGIN="15"
      MARGINHEIGHT="15"
      LEFTMARGIN="15"
      MARGINWIDTH="15">

<!--#include virtual="/INCLUDES/header.html" -->

<H1>    Fortran-90 <CODE>MODULE MODATTS3</CODE> </H1>

<EM>New for I/O&nbsp;API-3.2!!</EM>  Developed from (and extends) I/O&nbsp;API-3.1
<CODE>MODULE MATXATTS</CODE>.

<H2>Summary</H2>

    <BLOCKQUOTE>
    Fortran-90 style <CODE>MODULE MODATTS3</CODE> uses the I/O&nbsp;API
    &quot;extra-attributes&quot; interface to provide CF-compliant
    <A HREF="http://cfconventions.org/">CF-convention</A> geospatial
    metadata, and CMAQ-standard, and SMOKE-standard metadata for newly-created
    I/O&nbsp;API files and input-grid and output-grid metadata for
    I/O&nbsp;API matrix-files, in terms of <A HREF="GRIDS.html#horiz">
    Models-3 I/O&nbsp;API map projection and grid description
    conventions.</A>
    <P>
    Note that adding metadata to a file to which data have already been
    written may entail substantial overhead (both of time and
    disk-space):  the &quot;system&quot; will have to make a new copy of
    the file with both the new metadata and the existing data, and then
    rename it behind the scenes.
    <P>
    The following <VAR>m3tools</VAR> programs examine their input files
    to see whether CMAQ metadata is present; if so they examine
    environment variable <CODE>COPY_META</CODE> (default
    <CODE>TRUE</CODE>) to determine whether or not to copy that metadata
    to their output file(s):
    <BLOCKQUOTE>
    <DL>
        <DT><VAR>m3combo</VAR>
        <DT><VAR>m3cple</VAR>
        <DT><VAR>m3interp</VAR>
        <DT><VAR>m3tproc</VAR>
        <DT><VAR>m3tshift</VAR>
        <DT><VAR>m3wndw</VAR>
        <DT><VAR>m3xtract</VAR>
    </DL>
    </BLOCKQUOTE>
    <P>
    </BLOCKQUOTE>

<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="usage">
USAGE of <CODE>MODULE MODATTS3</CODE>
</A></H3>

    <BLOCKQUOTE>
    <DL>
        <DT> <STRONG>Matrix Attributes</STRONG> for geospatial-transform
             matrices
        <DD> Geospatial-transform metadata gives the grid description
             for both the input and the output map projection and grid
             for a matrix:
             <BLOCKQUOTE><CODE>
                GDTYP, P_ALP, P_BET, P_GAM, XCENT, YCENT,
                XORIG, YORIG, XCELL, YCELL, NCOLS, NROWS,
             </CODE></BLOCKQUOTE>
             This module contains generic routines for setting,
             retrieving, and checking input-grid,  output-grid, or both
             input- and output-grid metadata for files used to store
             geospatial transform matrices:
              <DL "compact">
                    <DT> <CODE>INITMTXATT()</CODE>
                    <DD>  stores input and/or output grid description to
                          internal state variables.
                    <DT> <CODE>SETMTXATT()</CODE>
                    <DD>  stores input and/or output grid description to
                          an M3IO file-header.
                    <DT> <CODE>GETMTXATT()</CODE>
                    <DD> retrieves input and/or output grid description
                         (as stored by <CODE>SETMTXATT()</CODE>) from 
                          an M3IO file-header.
                    <DT> <CODE>CHKMTXATT()</CODE>
                    <DD> compares input and/or output grid description
                         (as stored by <CODE>SETMTXATT()</CODE>) from 
                         an M3IO file-header with grid description(s)
                         supplied as arguments.
              </DL>
        <P>

        <DT> <STRONG>CF-Convention Metadata</STRONG>
        <DD> See <A HREF="http://cfconventions.org/">http://cfconventions.org/</A>.
        <BR>
             CF metadata is used by the global climate community
             as well as by a number of third-party applications.
             <P>
             Turned on by <STRONG><VAR>setenv&nbsp;IOAPI_CFMETA&nbsp;YES
             </VAR></STRONG> [default
             <STRONG><CODE>NO</CODE></STRONG>]. If turned on, all
             newly-created files will be given this metadata in their
             file headers and in CF specified auxilliary variables.
             (These last should not  have been necessary if the CF
             authors had actually known what they were doing with
             netCDF; it is the reason for the restrictions on
             <CODE>SETCF()</CODE> below.).
             <P>
             Also, <CODE>LOGICAL FUNCTION SETCF(FNAME)</CODE> creates CF
             metadata in the file with logical name <CODE>FNAME</CODE>,
             provided it is opened for output.<BR>
             <EM>This routine needs to be called before any data is
             written to the file.</EM>
             <P>
             
        <P>

        <DT> <STRONG>&quot;Standard&quot; CMAQ Metadata</STRONG>
        <DD> Turned on/off by <STRONG><VAR>setenv&nbsp;IOAPI_CMAQMETA...</VAR></STRONG>
             with the following values:             
             <BLOCKQUOTE><DL "compact">
                    <DT> <STRONG><CODE>NONE</CODE></STRONG>:  turned off [default]
                    <P>
                    <DT> <STRONG><CODE>ENV</CODE></STRONG>:  get metadata from
                    environment variables.  These include both
                    the standard CMAQ environment variables, as
                    well as the following new environment variables
                    (whose values are described below):
                    <BLOCKQUOTE><CODE>
                    PROJECT, CASE, EPISODE, SPONSOR, CMAQVERS, MCIPVERS, 
                    EMISVERS, METVERS, CMAQCFG, MCIPCFG, EMISCFG, ICBCCFG, 
                    METCFG
                    </CODE></BLOCKQUOTE>
                    Note that the values of these in <VAR>setenv</VAR> 
                    statements need to be quoted, in order to preserve
                    blanks and other white-space.
                    <P>
                    <DT> <STRONG><VAR>path-name</VAR></STRONG>:  get metadata from
                    the indicated structured ASCII file.  This file should consist
                    of lines of the form
                    <BLOCKQUOTE><CODE>
                    &lt;name&gt; = &lt;value&gt; 
                    </CODE></BLOCKQUOTE>
                    for the following set of names (also described
                    below):
                    <BLOCKQUOTE><CODE>
                    PROJECT, CASE, EPISODE, SPONSOR, CMAQVERS, MCIPVERS, 
                    EMISVERS, METVERS, CMAQCFG, MCIPCFG, EMISCFG, ICBCCFG, 
                    METCFG,SYNC_TOP, MAXSYNC, MINSYNC, WB_DUST, ERODE_AGLAND,
                    WBDUST_BELD, LTNG_NO, KZMIN, ILDEPV, MOSAIC, ABFLUX,
                    HGBIDI, SFC_HONO, BIOGEMIS, PT3DEMIS, CLD_DIAG, AERDIAG,
                    PHOTDIAG, SSEMDIAG, DUSTEM_DIAG, LTNGDIAG, B3GTS_DIAG,
                    PT3DDIAG, PT3DFRAC
                    </CODE></BLOCKQUOTE>
             </DL></BLOCKQUOTE>
             This module contains definitions for CMAQ metadata-objects,
             and generic routines for setting,
             retrieving, and logging such metadata:
             <BLOCKQUOTE> <DL "compact">
                    <DT> <CODE>INITCMAQ()</CODE>
                    <DD>  stores metadata into internal state variables,
                          and turns on CMAQ-metadata output for newly
                          created files.  Can be called automatically
                          (as above) or manually, optionally with 
                          user specified metadata-object.
                    <DT> <CODE>ISCMAQ()</CODE>
                    <DD>  Checks whether an M3IO file header contains
                          CMAQ metadata.
                    <DT> <CODE>GETCMAQ()</CODE>
                    <DD>  Retrieves CMAQ metadata from an M3IO
                          file-header, and optionally places it
                          in a user supplied CMAQ-metadata object.
                    <DT> <CODE>SETCMAQ()</CODE>
                    <DD> Stores CMAQ metadata to an M3IO file-header,
                         optionally from a user supplied CMAQ-metadata object.
                    <DT> <CODE>LOGCMAQ()</CODE>
                    <DD> Writes structured ASCII <CODE>IOAPI_CFMETA</CODE>-format
                         metadata to either program-log or to a user
                         specified output file, optionally from a user
                         supplied CMAQ-metadata object.
              </DL></BLOCKQUOTE>
        <P>

        <DT> <STRONG>&quot;Unstructured text-file&quot; Metadata</STRONG>
        <DD> Turned on/off by either a call to <VAR>INITMTEXT()</VAR>
        with the relevant text-data content, or by
        <STRONG><VAR>setenv&nbsp;IOAPI_TEXTMETA...</VAR></STRONG>
             with the following values:             
             <BLOCKQUOTE><DL "compact">
                    <DT> <STRONG><CODE>NONE</CODE></STRONG>:  turned off [default]
                    <P>
                    <DT> <STRONG><VAR>path-name</VAR></STRONG>:  get metadata from
                    the indicated structured ASCII file.  This file should consist
                    of lines of length at most <CODE>MXDLEN3=80</CODE>
                    characters.
                    <P>
              </DL></BLOCKQUOTE>
              If active, the resulting text metadata can be found in the
              following <CODE>MODULE</CODE>-variables in 
              <CODE>MODULE&nbsp;MODATTS3</CODE>:
              <PRE>
              LOGICAL,                   PUBLIC, PROTECTED, SAVE :: TEXTMETA          !!  text-file metadata active?
              INTEGER,                   PUBLIC, PROTECTED, SAVE :: TEXT_MLINES       !!  number of lines in TEXT_MDATA( :,: )
              CHARACTER*80, ALLOCATABLE, PUBLIC, PROTECTED, SAVE :: TEXT_MDATA( : )   !!  (TEXT_MLINES)
              </PRE>
              For newly created files, the data will be stored in
              global attribute <CODE>TEXT_MDATA</CODE>; if you wish 
              to look at this metadata for an &quot;old&quot; file
              from within a program, use routine
              <A HREF="INQATT3.html">INQATT3()</A> to find the size of
              the metadata, <CODE>ALLOCATE</CODE> a buffer for it, and
              then read it with <A HREF="RDATT3.html">RDATTC()</A>
              and process it as desired. (You could use
              <A HREF="WRATT3.html">WRATTC()</A> to fake the
              operation of all this, if you wish :-) )
              <P>
             This module contains definitions for routines for
             initializing and setting such metadata:
             <BLOCKQUOTE> <DL "compact">
                    <DT> <CODE>INITMTEXT()</CODE>
                    <DD>  reads metadata from the file into internal
                          state variable <CODE>TEXT_MDATA</CODE>
                          Can be called automatically
                          (as above) or manually.
                    <DT> <CODE>SETMTEXT()</CODE>
                    <DD> Stores text metadata  from state variable <CODE>TEXT_MDATA</CODE> 
                         to an M3IO file-header.
                    <DT> <CODE>ENDMTEXT()</CODE>
                    <DD> Turns text metadata off and deallocates <CODE>TEXT_MDATA</CODE>
              </DL></BLOCKQUOTE>
              <STRONG><EM>NOTE</EM></STRONG> that the netCDF get-text-attribute routines
              <STRONG>do not check string-sizes nor pad with
              blanks</STRONG> the way the Fortran standard suggests
              they should.
              <P>
              <STRONG><EM>NOTE ALSO</EM></STRONG> that the standard UNIX/Linux utility
              <STRONG><VAR>fold</VAR></STRONG> can be used to create 80-column text files
              from text-files with longer line-lengths.
              <P>
        <P>

        <DT> <STRONG>&quot;Standard&quot; SMOKE Metadata</STRONG>
        <DD> Not yet implemented.
        <P>

    </DL>
    </BLOCKQUOTE>

<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="contents">
Definitions and Declarations in <CODE>MODULE MODATTS3</CODE>
</A></H3>

    <BLOCKQUOTE>
    <DL>
        <DT> <CODE>LOGICAL, PUBLIC, PROTECTED :: MATXMETA</CODE>
        <DD> <CODE>TRUE</CODE> if and only if matrix-metadata is
             turned on, and available in the module
             <P>
        <DT> <CODE>LOGICAL, PUBLIC, PROTECTED :: CFMETA</CODE>
        <DD> <CODE>TRUE</CODE> if and only if CF-metadata is
             turned on, and available in the module
             <P>
        <DT> <CODE>LOGICAL, PUBLIC, PROTECTED :: CMAQMETA</CODE>
        <DD> <CODE>TRUE</CODE> if and only if CMAQ-metadata is
             turned on, and available in the module
             <P>
        <DT> <CODE>LOGICAL, PUBLIC, PROTECTED :: TEXTMETA</CODE>
        <DD> <CODE>TRUE</CODE> if and only if ASCII text-file metadata 
             is turned on, and available in the module.
             <P>
        <DT> <CODE>LOGICAL, PUBLIC, PROTECTED :: SMOKEMETA</CODE>
        <DD> <CODE>TRUE</CODE> if and only if SMOKE-metadata is
             turned on, and available in the module<BR>
             <EM>SMOKE-metadata is not yet implemented, and
             may never be ;-( </EM>
             <P>
        <DT> &nbsp;

        <DT> <CODE>TYPE CMETA_T</CODE>
        <DD> Derived data type for standard CMAQ metadata objects.
             See <A HREF="http://www.airqualitymodeling.org/cmaqwiki/index.php?title=CMAQ_version_5.0_%28February_2010_release%29_OGD#Files.2C_configuration.2C_and_environment_variables_3">this section of the CMAQ Wiki</A>
             for more information
             <BR>
             The fields are the following:
             <DL>
                <DT><CODE>INTEGER :: VERSION3</CODE>
                <DD>Version-number for the CMAQ-metadata data dictionary

                <DT><CODE>CHARACTER*32 :: PROJECT</CODE>
                <DD>Current modeling-project name

                <DT><CODE>CHARACTER*32 :: CASE</CODE>
                <DD>Current modeling-case name

                <DT><CODE>CHARACTER*32 :: EPISODE</CODE>
                <DD>Current modeling-episode name

                <DT><CODE>CHARACTER*32 :: SPONSOR</CODE>
                <DD>Current modeling-project sponsor's name

                <DT><CODE>CHARACTER*32 :: CMAQVERS</CODE>
                <DD>CMAQ model version

                <DT><CODE>CHARACTER*32 :: MCIPVERS</CODE>
                <DD>MCIP model version

                <DT><CODE>CHARACTER*32 :: EMISVERS</CODE>
                <DD>Current emissions model name and version

                <DT><CODE>CHARACTER*256 :: METVERS</CODE>
                <DD>Current meteorology-model name and version

                <DT><CODE>CHARACTER*256 :: CMAQCFG</CODE>
                <DD>CMAQ configuration (as text)

                <DT><CODE>CHARACTER*256 :: MCIPCFG</CODE>
                <DD>MCIP configuration (as text)

                <DT><CODE>CHARACTER*256 :: EMISCFG</CODE>
                <DD>Emissions-model configuration (as text)

                <DT><CODE>CHARACTER*256 :: ICBCCFG</CODE>
                <DD>IC/BC configuration (as text)

                <DT><CODE>CHARACTER*256 :: METCFG</CODE>
                <DD>Meteorology-model configuration (as text)

                <DT><CODE>CHARACTER*512 :: LTNGNO</CODE>
                <DD>&quot;inline&quot; or path for lightning file <CODE>LTNG_NO</CODE>, or ...

                <DT><CODE>CHARACTER*512 :: OCEAN</CODE>
                <DD>Path for file <CODE>OCEAN_1</CODE>

                <DT><CODE>CHARACTER*512 :: EMIS</CODE>
                <DD>Path for file <CODE>EMIS_1</CODE>

                <DT><CODE>CHARACTER*512 :: GCBDY</CODE>
                <DD>Path for file <CODE>BNDY_GASC_1</CODE>

                <DT><CODE>CHARACTER*512 :: AEBDY</CODE>
                <DD>Path for file <CODE>BNDY_AERO_1</CODE>

                <DT><CODE>CHARACTER*512 :: NRBDY</CODE>
                <DD>Path for file <CODE>BNDY_NONR_1</CODE>

                <DT><CODE>CHARACTER*512 ::TRBDY </CODE>
                <DD>Path for file <CODE>BNDY_TRAC_1</CODE>

                <DT><CODE>CHARACTER*512 ::GCINIT </CODE>
                <DD>Path for file <CODE>INIT_GASC_1</CODE>

                <DT><CODE>CHARACTER*512 :: AEINIT</CODE>
                <DD>Path for file <CODE>INIT_AERO_1</CODE>

                <DT><CODE>CHARACTER*512 ::NRINIT </CODE>
                <DD>Path for file <CODE>INIT_NONR_1</CODE>

                <DT><CODE>CHARACTER*512 :: TRINIT</CODE>
                <DD>Path for file <CODE>INIT_TRAC_1</CODE>

                <DT><CODE>CHARACTER*512 ::GCNML </CODE>
                <DD>Path for file <CODE>gc_matrix_nml</CODE>

                <DT><CODE>CHARACTER*512 :: AENML</CODE>
                <DD>Path for file <CODE>ae_matrix_nml</CODE>

                <DT><CODE>CHARACTER*512 :: NRNML</CODE>
                <DD>Path for file <CODE>nr_matrix_nml</CODE>

                <DT><CODE>CHARACTER*512 :: TRNML</CODE>
                <DD>Path for file <CODE>tr_matrix_nml</CODE>

                <DT><CODE>CHARACTER*512 :: GRDCRO2</CODE>
                <DD>Path for file <CODE>GRID_CRO_2D</CODE>

                <DT><CODE>CHARACTER*512 :: GRDDOT2</CODE>
                <DD>Path for file <CODE>GRID_DOT_2D</CODE>

                <DT><CODE>CHARACTER*512 :: METCRO2</CODE>
                <DD>Path for file <CODE>MET_CRO_2D</CODE>

                <DT><CODE>CHARACTER*512 :: METCRO3</CODE>
                <DD>Path for file <CODE>MET_CRO_3D</CODE>

                <DT><CODE>CHARACTER*512 :: METDOT3</CODE>
                <DD>Path for file <CODE>MET_DOT_3D</CODE>

                <DT><CODE>CHARACTER*512 :: METBDY3</CODE>
                <DD>Path for file <CODE>MET_BDY_3D</CODE>

                <DT><CODE>CHARACTER*512 :: XJDATA</CODE>
                <DD>Path for file <CODE>XJ_DATA</CODE>

                <DT><CODE>CHARACTER*512 :: GSPRO</CODE>
                <DD>Path for file <CODE>GSPRO</CODE>

                <DT><CODE>CHARACTER*512 :: B3GRD</CODE>
                <DD>Path for file <CODE>B3GRD</CODE>

                <DT><CODE>CHARACTER*512 :: SOILINP</CODE>
                <DD>Path for file <CODE>SOILINP</CODE>

                <DT><CODE>CHARACTER*512 :: CSQYDATA</CODE>
                <DD>Path for file <CODE>CSQY_DATA</CODE>

                <DT><CODE>REAL :: SYNC_TOP</CODE>
                <DD>Value of CMAQ environment variable <CODE>SIGMA_SYNC_TOP</CODE>:<BR>
                top sigma level thru which sync step determined

                <DT><CODE>INTEGER :: MAXSYNC</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_MAXSYNC</CODE>:<BR>
                max sync time step (sec)

                <DT><CODE>INTEGER :: MINSYNC</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_MINSYNC</CODE>:<BR>
                min sync time step (sec)

                <DT><CODE>INTEGER :: EMISDATE</CODE>
                <DD>Value of CMAQ environment variable <CODE>EMISDATE</CODE>:<BR>
                (non-standard-format) Gregorian date for emissions inputs (YYYYMMDD)

                <DT><CODE>INTEGER :: EMISDATE</CODE>
                <DD>Value of CMAQ environment variable <CODE>EMISDATE</CODE>:<BR>
                Date for layer-fraction inputs (YYYYDDD)

                <DT><CODE>CHARACTER*8 :: WBDUST_BELD</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_WBDUST_BELD</CODE>:<BR>
                Flag &quot; landuse database for identifying dust source regions [ default: BELD3 ]&quot;

                <P>

             </DL>

                <EM>For the following, environment values should be
                &quot;T&quot; or &quot;F&quot;, Internally, these
                values are stored accordng to C conventions:
                <BLOCKQUOTE>
                <CODE>1</CODE> represents <CODE>LOGICAL TRUE</CODE><BR>
                <CODE>0</CODE> represents <CODE>LOGICAL FALSE</CODE><BR>
                <CODE>IMISS3=-9999</CODE> represents &quot;Missing&quot;
                </BLOCKQUOTE></EM>

             <DL>

                <DT><CODE>INTEGER :: CTM_CKSUM</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_CKSUM</CODE>:<BR>
                Flag &quot;  Do CKSUM() every time step?&quot;

                <DT><CODE>INTEGER :: WB_DUST</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_WB_DUST</CODE>:<BR>
                Flag &quot;  use in-line wind-borne dust computation?&quot;

                <DT><CODE>INTEGER :: ERODE_AGLAND</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_ERODE_AGLAND</CODE>:<BR>
                Flag &quot; use in-line wind-borne dust computation?&quot;

                <DT><CODE>INTEGER :: LTNGPARAM</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_LTNGPARAM</CODE>:<BR>
                Flag &quot; in-line lightning NOx computation?&quot;

                <DT><CODE>INTEGER :: CTM_WVEL</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_WVEL</CODE>:<BR>
                Flag &quot; output the CCTM-calculated vertical velocities?&quot;

                <DT><CODE>INTEGER :: KZMIN</CODE>
                <DD>Value of CMAQ environment variable <CODE>KZMIN</CODE>:<BR>
                Flag &quot; use Min Kz option in edyintb?&quot;

                <DT><CODE>INTEGER :: ILDEPV</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_ILDEPV</CODE>:<BR>
                Flag &quot; Is in-line deposition-velocity calculation active?&quot;

                <DT><CODE>INTEGER :: MOSAIC</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_MOSAIC</CODE>:<BR>
                Flag &quot; use landuse specific deposition velocities?&quot;

                <DT><CODE>INTEGER :: ABFLUX</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_ABFLUX</CODE>:<BR>
                Flag &quot; Use Ammonia bi-directional flux for in-line deposition velocities?&quot;

                <DT><CODE>INTEGER :: HGBIDI</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_HGBIDI</CODE>:<BR>
                Flag &quot; use Mercury bi-directional flux for in-line deposition velocities?&quot;

                <DT><CODE>INTEGER :: SFC_HONO</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_SFC_HONO</CODE>:<BR>
                Flag &quot; Use Surface HONO interaction in deposition velocities?&quot;

                <DT><CODE>INTEGER :: BIOGEMIS</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_BIOGEMIS</CODE>:<BR>
                Flag &quot; Are in-line biogenic emissions active?&quot;

                <DT><CODE>INTEGER :: PT3DEMIS</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_PT3DEMIS</CODE>:<BR>
                Flag &quot;  Is in-line plume rise active?&quot;

                <DT><CODE>INTEGER :: CLD_DIAG</CODE>
                <DD>Value of CMAQ environment variable <CODE>CLD_DIAG</CODE>:<BR>
                Flag &quot; write cloud diagnostic file?&quot;

                <DT><CODE>INTEGER :: AERDIAG</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_AERDIAG</CODE>:<BR>
                Flag &quot; write aerosol diagnostic file?&quot;

                <DT><CODE>INTEGER :: PHOTDIAG</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_PHOTDIAG</CODE>:<BR>
                Flag &quot; write photolysis diagnostic file?&quot;

                <DT><CODE>INTEGER :: SSEMDIAG</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_SSEMDIAG</CODE>:<BR>
                Flag &quot; write sea-salt emissions diagnostic file?&quot;

                <DT><CODE>INTEGER :: DUSTEM_DIAG</CODE>
                <DD>Value of CMAQ environment variable <CODE>CTM_DUSTEM_DIAG</CODE>:<BR>
                Flag &quot; write windblown dust emissions diagnostic file?&quot;

                <DT><CODE>INTEGER :: LTNGDIAG</CODE>
                <DD>Value of CMAQ environment variable <CODE>LTNGDIAG</CODE>:<BR>
                Flag &quot; write lightning diagnostic file?&quot;

                <DT><CODE>INTEGER :: B3GTS_DIAG</CODE>
                <DD>Value of CMAQ environment variable <CODE>B3GTS_DIAG</CODE>:<BR>
                Flag &quot; write beis mass emissions diagnostic file?&quot;

                <DT><CODE>INTEGER :: PT3DDIAG</CODE>
                <DD>Value of CMAQ environment variable <CODE>PT3DDIAG</CODE>:<BR>
                Flag &quot; write 3d point source emissions diagnostic file?&quot;

                <DT><CODE>INTEGER :: PT3DFRAC</CODE>
                <DD>Value of CMAQ environment variable <CODE>PT3DFRAC</CODE>:<BR>
                Flag &quot; write layer fractions diagnostic?&quot;

             </DL>
             <P>

        <DT> <CODE>TYPE SMETA_T</CODE>
        <DD> Derived data type for standard SMOKE metadata objects, if
             that ever happens (currently, only a dummy implementation).<BR>
             The fields are the following:
             <DL>
                <DT><CODE>INTEGER :: VERSION</CODE>
                <DD>Version-number for the SMOKE-metadata data dictionary
             </DL>
             <P>

        <DT> <CODE>TYPE( CMETA_T ), PUBLIC, PROTECTED :: CMAQ_MDATA</CODE>
        <DD> Module state-object for CMAQ metadata.  If <CODE>CMAQMETA</CODE>,
             holds standard CMAQ metadata.
             <P>

        <DT> <CODE>INTEGER, PUBLIC, PROTECTED :: TEXT_MLINES</CODE>
        <DD> Number of lines of ASCII text metadata.
             Negative if ASCII text-file metadata not active
             <P>
        <DT> <CODE>CHARACTER*80, PUBLIC, PROTECTED :: TEXT_MDATA( TEXT_MLINES )</CODE>
        <DD> Structured-ASCII file metadata.
             <P>
        <DT> &nbsp;

        <DT> <CODE>TYPE( SMETA_T ), PUBLIC, PROTECTED :: SMOKE_MDATA</CODE>
        <DD> Module state-object for SMOKE metadata.  If <CODE>SMOKEMETA</CODE>,
             holds standard SMOKE metadata.
             <P>
        <DT> &nbsp;

        <DT> <CODE>INTEGER, PARAMETER :: INGRD3</CODE>
        <DD> Token to use in matrix-attribute calls to indicate that the
             grid whose metadata is being accessed is an input grid for
             the matrix.
             <P>
        <DT> <CODE>INTEGER, PARAMETER :: OUTGRD3</CODE>
        <DD> Token to use in matrix-attribute calls to indicate that the
             grid whose metadata is being accessed is an output grid for the
             matrix.
             <P>
        <DT> &nbsp;
        <DT> <CODE><A HREF="#getmtxatt">GETMTXATT()</A></CODE>
        <DD> get input or output grid description attributes for
             matrix-files and return as arguments:<BR>
             <EM>Generic with forms for matrix-input-only, matrix-output-only,
             matrix-input-and-output metadata</EM>
             <P>
        <DT> <CODE><A HREF="#initmtxatt">INITMTXATT()</A></CODE>
        <DD> set state-variables for input and output grid description
             attributes for matrix-file.
             <P>
        <DT> <CODE><A HREF="#setmtxatt">SETMTXATT()</A></CODE>
        <DD> set or check input and output grid description attributes
             from arguments for matrix-files:  if file is NEW, set the
             attributes; else check them.  Retains these attributes
             in <CODE>PRIVATE</CODE> state-variables in the module.:<BR>
             <EM>Generic with forms for matrix-input-only, matrix-output-only,
             matrix-input-and-output metadata</EM>
             <P>
        <DT> <CODE><A HREF="#chkmtxatt">CHKMTXATT()</A></CODE>
        <DD> check input or output grid description attributes for
             matrix-files against attributes from  the argument list.
             Return <CODE>.TRUE.</CODE> if they match,
             <CODE>.FALSE.</CODE> otherwise.:<BR>
             <EM>Generic with forms for matrix-input-only, matrix-output-only,
             matrix-input-and-output metadata</EM>
             <P>
        <DT> <CODE><A HREF="#endmtxatt">ENDMTXATT()</A></CODE>
        <DD> turn off input and output grid description attributes
        from <CODE>INITMTXATT()</CODE> or <CODE>SETMTXATT()</CODE>
             <P>
        <DT> &nbsp;

        <DT> <CODE><A HREF="#initcf">INITCF()</A></CODE>
        <DD> turns on CF-metadata for all new files created
             <P>
        <DT> <CODE><A HREF="#setcf">SETCF()</A></CODE>
        <DD> writes CF-metadata for a specific file.
             <P>
        <DT> <CODE><A HREF="#endcf">ENDCF()</A></CODE>
        <DD> turns off writing CF metadata for new files created
             subsequently.
             <P>

        <DT> &nbsp;
        <DT> <CODE><A HREF="#initcmaq">INITCMAQ()</A></CODE>
        <DD> turns on CMAQ-metadata for all new files created
             <P>
        <DT> <CODE><A HREF="#iscmaq">ISCMAQ()</A></CODE>
        <DD> Checks whether CMAQ-metadata exists in a specified file
             <P>
        <DT> <CODE><A HREF="#getcmaq">GETCMAQ()</A></CODE>
        <DD> reads CMAQ-metadata from a specific file.
             <P>
        <DT> <CODE><A HREF="#logcmaq">LOGCMAQ()</A></CODE>
        <DD> print human readable CMAQ-metadata.
             <P>
        <DT> <CODE><A HREF="#setcmaq">SETCMAQ()</A></CODE>
        <DD> writes CMAQ-metadata for a specific file.
             <P>
        <DT> <CODE><A HREF="#endcmaq">ENDCMAQ()</A></CODE>
        <DD> turns off writing CMAQ metadata for new files created
             subsequently.
             <P>

        <DT> &nbsp;
        <DT> <CODE><A HREF="#initmtext">INITMTEXT()</A></CODE>
        <DD> turns on text-file metadata for all new files created
             <P>
        <DT> <CODE><A HREF="#setmtext">SETMTEXT()</A></CODE>
        <DD> writes text-file metadatametadata for a specific file.
             <P>
        <DT> <CODE><A HREF="#endmtext">ENDMTEXT()</A></CODE>
        <DD> turns off writing text-file metadatametadata for new files created
             subsequently.
             <P>

        <DT> &nbsp;
        <DT> <CODE><A HREF="#initsmoke">INITSMOKE()</A></CODE>
        <DD> turns on SMOKE-metadata for all new files created
             <P>
        <DT> <CODE><A HREF="#getsmoke">GETSMOKE()</A></CODE>
        <DD> reads SMOKE-metadata from a specific file.
             <P>
        <DT> <CODE><A HREF="#setsmoke">SETSMOKE()</A></CODE>
        <DD> writes SMOKE-metadata for a specific file.
             <P>
        <DT> <CODE><A HREF="#endsmoke">ENDSMOKE()</A></CODE>
        <DD> turns off writing SMOKE metadata for new files created
             subsequently.
             <P>
        <P>
    </DL>

    </BLOCKQUOTE>

<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="initmtxatt"> INITMTXATT</A></H3>

    <PRE>
    SUBROUTINE  INITMTXATT(                                             &amp;
            GDNAM1, GDTYP1, P_ALP1, P_BET1, P_GAM1, XCENT1, YCENT1,     &amp;
                    XORIG1, YORIG1, XCELL1, YCELL1, NCOLS1, NROWS1,     &amp;
            GDNAM2, GDTYP2, P_ALP2, P_BET2, P_GAM2, XCENT2, YCENT2,     &amp;
                    XORIG2, YORIG2, XCELL2, YCELL2, NCOLS2, NROWS2 )

        CHARACTER( LEN=* ), INTENT( IN ) :: GDNAM1, GDNAM2
        INTEGER           , INTENT( IN ) :: GDTYP1, GDTYP2
        REAL*8            , INTENT( IN ) :: P_ALP1, P_ALP2
        REAL*8            , INTENT( IN ) :: P_BET1, P_BET2
        REAL*8            , INTENT( IN ) :: P_GAM1, P_GAM2
        REAL*8            , INTENT( IN ) :: XCENT1, XCENT2
        REAL*8            , INTENT( IN ) :: YCENT1, YCENT2
        REAL*8            , INTENT( IN ) :: XORIG1, XORIG2
        REAL*8            , INTENT( IN ) :: YORIG1, YORIG2
        REAL*8            , INTENT( IN ) :: XCELL1, XCELL2
        REAL*8            , INTENT( IN ) :: YCELL1, YCELL2
        INTEGER           , INTENT( IN ) :: NCOLS1, NCOLS2
        INTEGER           , INTENT( IN ) :: NROWS1, NROWS2
    </PRE>

    The first set of arguments
    <CODE>GDNAM1</CODE>&nbsp;...&nbsp;<CODE>NROWS1</CODE> are for the
    matrix-input grid;  the last set of arguments
    <CODE>GDNAM2</CODE>&nbsp;...&nbsp;<CODE>NROWS2</CODE> for the
    matrix-output grid.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="getmtxatt"> GETMTXATT</A></H3>

    <PRE>
    GENERIC INTERFACE:
    LOGICAL FUNCTION  GETMTXATT( FNAME, IMODE, GDNAM,                       &amp;
                                 GDTYP, P_ALP, P_BET, P_GAM, XCENT, YCENT,  &amp;
                                 XORIG, YORIG, XCELL, YCELL, NCOLS, NROWS )

        CHARACTER( LEN=* ), INTENT(  IN ):: FNAME  !! logical file name
        INTEGER           , INTENT(  IN ):: IMODE  !! INGRD3 or OUTGRD3
        CHARACTER( LEN=* ), INTENT( OUT ):: GDNAM  !! grid name
        INTEGER           , INTENT( OUT ):: GDTYP  !! map projection type
        REAL*8            , INTENT( OUT ):: P_ALP  !! map projection parameters...
        REAL*8            , INTENT( OUT ):: P_BET  !!  "
        REAL*8            , INTENT( OUT ):: P_GAM  !!  "
        REAL*8            , INTENT( OUT ):: XCENT  !!  "
        REAL*8            , INTENT( OUT ):: YCENT  !!  "
        REAL*8            , INTENT( OUT ):: XORIG  !! Grid origin
        REAL*8            , INTENT( OUT ):: YORIG  !!  "
        REAL*8            , INTENT( OUT ):: XCELL  !! Grid cell-size
        REAL*8            , INTENT( OUT ):: YCELL  !!  "
        INTEGER           , INTENT( OUT ):: NCOLS  !! Grid dimension
        INTEGER           , INTENT( OUT ):: NROWS  !!  "

    LOGICAL FUNCTION  GETMTXATT( FNAME,                                 &amp;
            GDNAM1, GDTYP1, P_ALP1, P_BET1, P_GAM1, XCENT1, YCENT1,     &amp;
                    XORIG1, YORIG1, XCELL1, YCELL1, NCOLS1, NROWS1,     &amp;
            GDNAM2, GDTYP2, P_ALP2, P_BET2, P_GAM2, XCENT2, YCENT2,     &amp;
                    XORIG2, YORIG2, XCELL2, YCELL2, NCOLS2, NROWS2 )

        CHARACTER( LEN=* ), INTENT(IN   ) :: FNAME
        CHARACTER( LEN=* ), INTENT(  OUT) :: GDNAM1, GDNAM2
        INTEGER           , INTENT(  OUT) :: GDTYP1, GDTYP2
        REAL*8            , INTENT(  OUT) :: P_ALP1, P_ALP2
        REAL*8            , INTENT(  OUT) :: P_BET1, P_BET2
        REAL*8            , INTENT(  OUT) :: P_GAM1, P_GAM2
        REAL*8            , INTENT(  OUT) :: XCENT1, XCENT2
        REAL*8            , INTENT(  OUT) :: YCENT1, YCENT2
        REAL*8            , INTENT(  OUT) :: XORIG1, XORIG2
        REAL*8            , INTENT(  OUT) :: YORIG1, YORIG2
        REAL*8            , INTENT(  OUT) :: XCELL1, XCELL2
        REAL*8            , INTENT(  OUT) :: YCELL1, YCELL2
        INTEGER           , INTENT(  OUT) :: NCOLS1, NCOLS2
        INTEGER           , INTENT(  OUT) :: NROWS1, NROWS2
    </PRE>

    <CODE>GDNAM1</CODE> ... <CODE>NROWS1</CODE> are for the matrix-input
    grid;  <CODE>GDNAM2</CODE> ... <CODE>NROWS2</CODE> for the
    matrix-output grid.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="setmtxatt">SETMTXATT</A></H3>

    <PRE>
    GENERIC INTERFACE:
    LOGICAL FUNCTION  SETMTXATT( FNAME, IMODE, GDNAM,                       &amp;
                                 GDTYP, P_ALP, P_BET, P_GAM, XCENT, YCENT,  &amp;
                                 XORIG, YORIG, XCELL, YCELL, NCOLS, NROWS )

        CHARACTER( LEN=* ), INTENT( IN ):: FNAME  !! logical file name
        INTEGER           , INTENT( IN ):: IMODE  !! INGRD3 or OUTGRD3
        CHARACTER( LEN=* ), INTENT( IN ):: GDNAM  !! grid name
        INTEGER           , INTENT( IN ):: GDTYP  !! map projection type
        REAL*8            , INTENT( IN ):: P_ALP  !! map projection parameters...
        REAL*8            , INTENT( IN ):: P_BET  !!  "
        REAL*8            , INTENT( IN ):: P_GAM  !!  "
        REAL*8            , INTENT( IN ):: XCENT  !!  "
        REAL*8            , INTENT( IN ):: YCENT  !!  "
        REAL*8            , INTENT( IN ):: XORIG  !! Grid origin
        REAL*8            , INTENT( IN ):: YORIG  !!  "
        REAL*8            , INTENT( IN ):: XCELL  !! Grid cell-size
        REAL*8            , INTENT( IN ):: YCELL  !!  "
        INTEGER           , INTENT( IN ):: NCOLS  !! Grid dimension
        INTEGER           , INTENT( IN ):: NROWS  !!  "

    LOGICAL FUNCTION  SETMTXATT( FNAME,                                 &amp;
            GDNAM1, GDTYP1, P_ALP1, P_BET1, P_GAM1, XCENT1, YCENT1,     &amp;
                    XORIG1, YORIG1, XCELL1, YCELL1, NCOLS1, NROWS1,     &amp;
            GDNAM2, GDTYP2, P_ALP2, P_BET2, P_GAM2, XCENT2, YCENT2,     &amp;
                    XORIG2, YORIG2, XCELL2, YCELL2, NCOLS2, NROWS2 )

        CHARACTER( LEN=* ), INTENT( IN ) :: FNAME
        CHARACTER( LEN=* ), INTENT( IN ) :: GDNAM1, GDNAM2
        INTEGER           , INTENT( IN ) :: GDTYP1, GDTYP2
        REAL*8            , INTENT( IN ) :: P_ALP1, P_ALP2
        REAL*8            , INTENT( IN ) :: P_BET1, P_BET2
        REAL*8            , INTENT( IN ) :: P_GAM1, P_GAM2
        REAL*8            , INTENT( IN ) :: XCENT1, XCENT2
        REAL*8            , INTENT( IN ) :: YCENT1, YCENT2
        REAL*8            , INTENT( IN ) :: XORIG1, XORIG2
        REAL*8            , INTENT( IN ) :: YORIG1, YORIG2
        REAL*8            , INTENT( IN ) :: XCELL1, XCELL2
        REAL*8            , INTENT( IN ) :: YCELL1, YCELL2
        INTEGER           , INTENT( IN ) :: NCOLS1, NCOLS2
        INTEGER           , INTENT( IN ) :: NROWS1, NROWS2

    LOGICAL FUNCTION  SETMTXATT3( FNAME )

        CHARACTER( LEN=* ), INTENT( IN ) :: FNAME
    </PRE>

    <CODE>GDNAM1</CODE> ... <CODE>NROWS1</CODE> are for the matrix-input
    grid;  <CODE>GDNAM2</CODE> ... <CODE>NROWS2</CODE> for the
    matrix-output grid.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="chkmtxatt">CHKMTXATT</A></H3>

    <PRE>
    GENERIC INTERFACE:
    LOGICAL FUNCTION  CHKMTXATT( FNAME, IMODE, GDNAM,                          &amp;
                                 GDTYP, P_ALP, P_BET, P_GAM, XCENT, YCENT,     &amp;
                                 XORIG, YORIG, XCELL, YCELL, NCOLS, NROWS )

        CHARACTER( LEN=* ), INTENT( IN ):: FNAME  !! logical file name
        INTEGER           , INTENT( IN ):: IMODE  !! INGRD3 or OUTGRD3
        CHARACTER( LEN=* ), INTENT( IN ):: GDNAM  !! grid name
        INTEGER           , INTENT( IN ):: GDTYP  !! map projection type
        REAL*8            , INTENT( IN ):: P_ALP  !! map projection parameters...
        REAL*8            , INTENT( IN ):: P_BET  !!  "
        REAL*8            , INTENT( IN ):: P_GAM  !!  "
        REAL*8            , INTENT( IN ):: XCENT  !!  "
        REAL*8            , INTENT( IN ):: YCENT  !!  "
        REAL*8            , INTENT( IN ):: XORIG  !! Grid origin
        REAL*8            , INTENT( IN ):: YORIG  !!  "
        REAL*8            , INTENT( IN ):: XCELL  !! Grid cell-size
        REAL*8            , INTENT( IN ):: YCELL  !!  "
        INTEGER           , INTENT( IN ):: NCOLS  !! Grid dimension
        INTEGER           , INTENT( IN ):: NROWS  !!  "

    LOGICAL FUNCTION  CHKMTXATT( FNAME,                             &amp;
           GDNAM1, GDTYP1, P_ALP1, P_BET1, P_GAM1, XCENT1, YCENT1,  &amp;
                   XORIG1, YORIG1, XCELL1, YCELL1, NCOLS1, NROWS1,  &amp;
           GDNAM2, GDTYP2, P_ALP2, P_BET2, P_GAM2, XCENT2, YCENT2,  &amp;
                   XORIG2, YORIG2, XCELL2, YCELL2, NCOLS2, NROWS2 )

        CHARACTER( LEN=* ), INTENT(IN   ) :: FNAME
        CHARACTER( LEN=* ), INTENT(IN   ) :: GDNAM1, GDNAM2
        INTEGER           , INTENT(IN   ) :: GDTYP1, GDTYP2
        REAL*8            , INTENT(IN   ) :: P_ALP1, P_ALP2
        REAL*8            , INTENT(IN   ) :: P_BET1, P_BET2
        REAL*8            , INTENT(IN   ) :: P_GAM1, P_GAM2
        REAL*8            , INTENT(IN   ) :: XCENT1, XCENT2
        REAL*8            , INTENT(IN   ) :: YCENT1, YCENT2
        REAL*8            , INTENT(IN   ) :: XORIG1, XORIG2
        REAL*8            , INTENT(IN   ) :: YORIG1, YORIG2
        REAL*8            , INTENT(IN   ) :: XCELL1, XCELL2
        REAL*8            , INTENT(IN   ) :: YCELL1, YCELL2
        INTEGER           , INTENT(IN   ) :: NCOLS1, NCOLS2
        INTEGER           , INTENT(IN   ) :: NROWS1, NROWS2

    LOGICAL FUNCTION  CHKMTXATT3( FNAME )

        CHARACTER( LEN=* ), INTENT( IN ):: FNAME

    </PRE>

    <CODE>GDNAM1</CODE> ... <CODE>NROWS1</CODE> are for the matrix-input
    grid;  <CODE>GDNAM2</CODE> ... <CODE>NROWS2</CODE> for the
    matrix-output grid.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="endmtxatt">ENDMTXATT</A></H3>

    <PRE>
    LOGICAL FUNCTION  ENDMTXATT( )
    </PRE>

    Turns off input and output grid description attributes
    from <CODE>INITMTXATT()</CODE> or <CODE>SETMTXATT()</CODE>:
    sets <CODE>MATXMETA&nbsp;=&nbsp;.FALSE.</CODE>.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="initcf">INITCF</A></H3>

    <PRE>
    SUBROUTINE  INITCF()
    </PRE>

    Turns on writing CF-compliant metadata for all new I/O&nbsp;API
    files subsequently created by the calling program.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="setcf">SETCF</A></H3>

    <PRE>
    GENERIC INTERFACE:
    SUBROUTINE  SETCF( FNAME )
    SUBROUTINE  SETCF( FID )

        CHARACTER( LEN=* ), INTENT( IN ) :: FNAME
        INTEGER           , INTENT( IN ) :: FID
    </PRE>

    <CODE>FNAME</CODE> must be the logical name of an I/O&nbsp;API
    file currently open for output, or else <CODE>FID</CODE> must be the
    internal file-index for a file currently being opened for output.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="endcf">ENDCF</A></H3>

    <PRE>
    SUBROUTINE  ENDCF()
    </PRE>

    Turns off writing CF-compliant metadata for new I/O&nbsp;API
    files subsequently opened by the calling program:
    sets <CODE>CFMETA&nbsp;=&nbsp;.FALSE.</CODE>.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>



<HR> <!- ------------------------------------------------------------- ->


<H3> <A NAME="initcmaq">INITCMAQ</A></H3>

    <PRE>
    GENERIC INTERFACE:
    LOGICAL FUNCTION  INITCMAQ()
    LOGICAL FUNCTION  INITCMAQ( MDATA )

        TYPE(CMETA_T) , INTENT( IN ) :: MDATA
    </PRE>

    Initializes internal state variables holding CMAQ-standard metadata
    from either the standard-format text file with logical name
    <CODE>IOAPI_CMAQMETA</CODE>, from the program-environment if
    <CODE>IOAPI_CMAQMETA=="ENV"</CODE> or from the argument <CODE>MDATA</CODE>.
    <P>
    <CODE>IOAPI_CMAQMETA</CODE> should be either <CODE>NONE</CODE> to
    turn off CMAQ metadata (the default), or the path for a
    structured-ASCII file with format [TBD].
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->


<H3> <A NAME="iscmaq">ISCMAQ</A></H3>

    <PRE>
    LOGICAL FUNCTION  ISCMAQ( FNAME )

        CHARACTER( LEN=* ), INTENT( IN ) :: FNAME
    </PRE>

    Returns <CODE>TRUE</CODE> if the specified file's header contains
    CMAQ metadata.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="getcmaq">GETCMAQ</A></H3>

    <PRE>
    GENERIC INTERFACE:
    LOGICAL FUNCTION  GETCMAQ( FNAME )
    LOGICAL FUNCTION  GETCMAQ( FNAME, MDATA )

        CHARACTER( LEN=* ), INTENT( IN ) :: FNAME
        TYPE(CMETA_T)     , INTENT( IN ) :: MDATA
    </PRE>

    Reads CMAQ-standard metadata from the header of file
    <CODE>FNAME</CODE> and puts it either into CMAQ-metadata object
    <CODE>MDATA</CODE> (if present) or into CMAQ-metadata module
    variable <CODE>CMAQ_MDATA</CODE>.  If successful, sets
    <CODE>CMAQMETA</CODE> to <CODE>TRUE</CODE>.
    <P>

    <CODE>FNAME</CODE> must be the logical name of an I/O&nbsp;API
    file currently open for input.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="logcmaq">LOGCMAQ</A></H3>

    <PRE>
    GENERIC INTERFACE:
    LOGICAL FUNCTION  LOGCMAQ(  )
    LOGICAL FUNCTION  LOGCMAQ( FNAME )
    LOGICAL FUNCTION  LOGCMAQ( MDATA )
    LOGICAL FUNCTION  LOGCMAQ( FNAME, MDATA )

        CHARACTER(LEN=*), INTENT( IN ) :: FNAME
        TYPE(CMETA_T)   , INTENT( IN ) :: MDATA
    </PRE>

    Writes CMAQ-standard metadata either from metadata-object
    <CODE>MDATA</CODE> (if present) or CMAQ-metadata module variable
    <CODE>CMAQ_MDATA</CODE> (otherwise) either to a structured-ASCII
    output file <CODE>FNAME</CODE> (if present) or to the program log
    (otherwise).
    <P>

    If present, <CODE>FNAME</CODE> must be the logical name for the
    structured-ASCII output file.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="setcmaq">SETCMAQ</A></H3>

    <PRE>
    GENERIC INTERFACE:
    LOGICAL FUNCTION  SETCMAQ( FID )
    LOGICAL FUNCTION  SETCMAQ( FID, MDATA  )
    LOGICAL FUNCTION  SETCMAQ( FNAME )
    LOGICAL FUNCTION  SETCMAQ( FNAME, MDATA )

        INTEGER           , INTENT( IN ) :: FID
        CHARACTER( LEN=* ), INTENT( IN ) :: FNAME
        TYPE(CMETA_T)     , INTENT( IN ) :: MDATA
    </PRE>

    Writes CMAQ-standard metadata either from metadata-object
    <CODE>MDATA</CODE> (if available) or CMAQ-metadata module variable
    <CODE>CMAQ_MDATA</CODE> (otherwise) to the header of I/O&nbsp;API
    file with either logical name <CODE>FNAME</CODE> or
    <CODE>STATE3</CODE> file-index <CODE>FID</CODE>.<BR>
    <EM>NOTE:  the last two forms are the ones intended for
    modeler-use; the first two should be considered as internal
    to the I/O&nbsp;API, and is the one called automatically.</EM>
    <P>
    If <CODE>IOAPI_CMAQMETA</CODE> is not <CODE>NONE</CODE>, the first
    form is called automatically as part of the file-creation process.
    <P>
    PRECONDITION:   <CODE>FNAME</CODE> must be the logical name of an
    I/O&nbsp;API file being opened or currently open for output.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="endcmaq">ENDCMAQ</A></H3>

    <PRE>
    SUBROUTINE  ENDCMAQ()
    </PRE>

    Turns off CMAQ-standard metadata:
    sets <CODE>MODULE</CODE>-variable <CODE>CMAQMETA&nbsp;=&nbsp;.FALSE.</CODE>.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>



<HR> <!- ------------------------------------------------------------- ->


<H3> <A NAME="initmtext">INITMTEXT</A></H3>

    <PRE>
    GENERIC INTERFACE:
    LOGICAL FUNCTION  INITMTEXT()
    LOGICAL FUNCTION  INITMTEXT( NLINES, LINES )

        INTEGER           , INTENT( IN ) :: NLINES
        CHARACTER( LEN=* ), INTENT( IN ) :: LINES( NLINES )
    </PRE>

    Initializes internal state variables holding structured-text
    metadata from the 80-col-format text file with logical name
    <CODE>IOAPI_TEXTMETA</CODE> or from the arguments. The first
    (no-arguments) form is automatically called before opening any
    newly-created files.  The second (explicit arguments) form 
    must be called before opening any new files.
    <P>
    Environment variable <CODE>IOAPI_TEXTMETA</CODE> should be either
    <CODE>NONE</CODE> to turn off text metadata (the default), or the
    path for the ASCII file.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->


<H3> <A NAME="setmtext">SETMTEXT</A></H3>

    <PRE>
    LOGICAL FUNCTION  SETMTEXT( FID )
        INTEGER           , INTENT( IN ) :: FID
    </PRE>

    Writes text-file metadata to attribute <CODE>TEXT_MDATA</CODE> in
    the header of [P]netCDF I/O&nbsp;API files open for writing.
    If text-file metadata is active, this is automatically called for
    newly-created files.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="endmtext">ENDMTEXT</A></H3>

    <PRE>
    SUBROUTINE  ENDMTEXT()
    </PRE>

    Turns off text-file metadata: sets <CODE>MODULE</CODE>-variable
    <CODE>TEXTMETA&nbsp;=&nbsp;.FALSE.</CODE> and deallocates
    <CODE>TEXT_MDATA</CODE>.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->



<H3> <A NAME="initsmoke">INITSMOKE</A></H3>

    <PRE>
    GENERIC INTERFACE:
    LOGICAL FUNCTION  INITSMOKE( )
    LOGICAL FUNCTION  INITSMOKE( MDATA )

        TYPE(SMETA_T)     , INTENT( IN ) :: MDATA
    </PRE>

    Initializes internal state variables holding SMOKE-standard metadata.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="getsmoke">GETSMOKE</A></H3>

    <PRE>
    GENERIC INTERFACE:
    LOGICAL FUNCTION  GETSMOKE( FNAME )
    LOGICAL FUNCTION  GETSMOKE( FNAME, MDATA )

        CHARACTER(LEN=*), INTENT( IN ) :: FNAME
        TYPE(SMETA_T)   , INTENT( IN ) :: MDATA
    </PRE>

    Reads SMOKE-standard metadata from the header of file
    <CODE>FNAME</CODE> and puts it either into SMOKE-metadata object
    <CODE>MDATA</CODE> or into SMOKE-metadata module variable
    <CODE>SMOKE_MDATA</CODE>.  If successful, sets <CODE>SMOKEMETA</CODE>
    to TRUE.
    <P>

    <CODE>FNAME</CODE> must be the logical name of an I/O&nbsp;API
    file currently open for input.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="setsmoke">SETSMOKE</A></H3>

    <PRE>
    GENERIC INTERFACE:
    LOGICAL FUNCTION  SETSMOKE( FID )
    LOGICAL FUNCTION  SETSMOKE( FNAME )
    LOGICAL FUNCTION  SETSMOKE( FNAME, MDATA )

        INTEGER           , INTENT( IN ) :: FID
        CHARACTER( LEN=* ), INTENT( IN ) :: FNAME
        TYPE(SMETA_T)     , INTENT( IN ) :: MDATA
    </PRE>

    Writes SMOKE-standard metadata either from metadata-object
    <CODE>MDATA</CODE> (if available) or SMOKE-metadata module variable
    <CODE>SMOKE_MDATA</CODE> (otherwise) to the header of I/O&nbsp;API file
    with either logical name <CODE>FNAME</CODE> or file-index
    <CODE>FID</CODE>.<BR>
    <EM>NOTE:  the last two forms are the ones intended for
    modeler-use; the first should be considered as internal
    to the I/O API, and is the one called automatically.</EM>
    <P>
    If <CODE>SMOKEMETA</CODE> is <CODE>TRUE</CODE>, the first form is
    called automatically as part of the file-creation process.
    <P>
    PRECONDITION:   <CODE>FNAME</CODE> must be the logical name of an
    I/O&nbsp;API file being opened or currently open for output.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<H3> <A NAME="endsmoke">ENDSMOKE</A></H3>

    <PRE>
    SUBROUTINE  ENDSMOKE()
    </PRE>

    Turns off SMOKE-standard metadata:
    sets <CODE>SMOKEMETA&nbsp;=&nbsp;.FALSE.</CODE>.
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!- ------------------------------------------------------------- ->

<A HREF = "AA.html">
To: <STRONG>Models-3/EDSS I/O API:   The Help Pages</STRONG>
</A><P>


Send comments to
<A HREF = "mailto:carlie@jyarborough.com"> <ADDRESS>
          Carlie J. Coats, Jr. <br>
          carlie@jyarborough.com  </ADDRESS> </A><P>

<!--#include virtual="/INCLUDES/footer.html" -->


</BODY>
</HTML>

