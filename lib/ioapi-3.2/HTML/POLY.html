
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<!-- "$Id: POLY.html 75 2018-01-12 15:48:16Z coats $" -->
<META NAME="MSSmartTagsPreventParsing" CONTENT="TRUE"> 
<TITLE> POLY() </TITLE>
</HEAD>

<BODY BGCOLOR    ="#FFFFFF" 
      TOPMARGIN   ="15" 
      MARGINHEIGHT="15" 
      LEFTMARGIN  ="15" 
      MARGINWIDTH ="15">

<H1>    POLY() </H1>

<H2> Fortran version: </H2>
<PRE>
    REAL FUNCTION  POLY( X, XPTS, YPTS, NDEG )
        INTEGER, INTENT(IN   ) :: NDEG              !  degree to use
        REAL   , INTENT(IN   ) :: X                 !  X-value to compute Y for
        REAL   , INTENT(IN   ) :: XPTS ( NDEG + 1 ) !  table of X-values to be used
        REAL   , INTENT(IN   ) :: YPTS ( NDEG + 1 ) !  table of Y-values to interpolate from
</PRE><P> 

<H2> C version:   </H2>
<PRE>
    float POLY( const float *x, 
                const float *xpts,
                const float *ypts,
                const int   *n ) ;
</PRE><P> 

<H2> Summary: </H2>

    <VAR>POLY()</VAR> returns the result of arbitrary-degree polynomial
    interpolation  for <CODE>X</CODE> on the curve determined by
    <CODE>XPTS</CODE> and <CODE>YPTS</CODE> using Newton 
    divided-differences.  Although strictly speaking no ordering
    assumptions are required, numerical stability is greatest
    (round-off  error is minimized) if the <CODE>XPTS</CODE> are in
    sorted order, and <CODE>X</CODE> lies near  the middle of the list.
    <P> 

    When interpolating from a large table, it is the 
    <STRONG>responsibility of the caller</STRONG> to pass the portion
    of the table appropriate for the <CODE>X</CODE> at which the
    interpolation is being evaluated.  Note that high-order polynomial
    interpolation is subject to Gibbs-Phenomenon numerical errors, and
    is to be avoided.
    <P>

    For Fortran-90 declarations and interface checking:    
    <PRE>
    <A HREF = "M3UTILIO.html">USE M3UTILIO</A>
    </PRE><P>

    <EM><STRONG>NOTE</STRONG></EM>:  high-order purely polynomial 
    interpolations have stability problems.  NDEG &lt;= 5 is recommended. 
    -- CJC
<P> 
    
    See also <A HREF = "PCOEF.html">PCOEF()</A>.
    <P> 


<H2> Preconditions: </H2>

    <CODE>#include &quot;iodecl3.h&quot;</CODE> if called from C.
    <P> 

    <CODE>X</CODE> should lie in the domain specified by the array
    <CODE>XPTS</CODE> of <CODE>X</CODE>-values  so that
    <VAR>POLY()</VAR> is doing interpolation instead of extrapolation.
    <P> 
    

<H2> Fortran Usage: </H2>
    Suppose <CODE>X</CODE> is between <CODE>XPT(17)</CODE> and
    <CODE>XPT(18)</CODE>, and you want to
    do a degree-3 interpolation (requiring <CODE>XPT(16) ... XPT(19)</CODE> ):
<PRE>
    ...
    USE M3UTILIO
    ...
    REAL      X, Y
    REAL      XPT( 100 )
    DATA      XPT / ... /
    REAL      YPT( 100 )
    DATA      YPT / ... /
    ...
    Y = POLY( X, XPT( 16 ), YPT( 16 ), 3 )   !  interpolate Y-values to X
    ...
</PRE><P> 

<H2> C Usage: </H2>
<PRE>
    ...
    #include &quot;iodecl3.h&quot;                          
    ...
    float  x, y, xpt[], ypt[] ;
    int    deg ;
    ...
    y = POLY( &amp;x, &amp;xpt, &amp;ypt, &amp;deg ) ; 
    /*  Now y is result of degree-deg polynomial interpolation of curve 
        determined by xpt[] and ypt[] to x */
    ...
</PRE><P> 


<HR>

<A HREF = "NAMEVAL.html" >
Previous:  <STRONG>NAMEVAL</STRONG>
</A><P> 

<A HREF = "PROMPTDFILE.html" >
Next:  <STRONG>PROMPTDFILE</STRONG>
</A><P> 

<A HREF = "AA.html#utility"> 
Up: <STRONG>Utility Routines</STRONG> 
</A><P>

<A HREF = "AA.html"> 
To: <STRONG>Models-3/EDSS I/O API:   The Help Pages</STRONG> 
</A><P>

</BODY>
</HTML>

