
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<!-- "$Id: CBARNES.html 1 2017-06-10 18:05:20Z coats $" -->
<META NAME="MSSmartTagsPreventParsing" CONTENT="TRUE"> 
<TITLE> CBARNES1() and CBARNESN() </TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFFF" 
      TOPMARGIN="15" 
      MARGINHEIGHT="15" 
      LEFTMARGIN="15" 
      MARGINWIDTH="15">
<H1>    CBARNES1() and CBARNESN() </H1>

<H2> Fortran version: </H2>
<PRE>
    SUBROUTINE CBARNES1( NG, LAT, LON,
 &amp;                      NP, YLAT, XLON, Z, WL50, GRID )

    SUBROUTINE CBARNESN( NG, LAT, LON,
 &amp;                      NP, NV, YLAT, XLON, ZN, WL50, GRIDN )

        INTEGER, INTENT(IN   ) :: NG               !  Number of output values (=NCOLS*NROWS)
        REAL   , INTENT(IN   ) :: LAT( NG )        !  single-indexed output latitudes
        REAL   , INTENT(IN   ) :: LON( NG )        !  single-indexed output longitudes
        INTEGER, INTENT(IN   ) :: NP               !  number of input sources
        INTEGER, INTENT(IN   ) :: NV               !  number of input variables
        REAL   , INTENT(IN   ) :: YLAT( NP )       !  input latitudes
        REAL   , INTENT(IN   ) :: XLON( NP )       !  input longitudes
        REAL   , INTENT(IN   ) :: Z   ( NP )       !  input values
        REAL   , INTENT(IN   ) :: ZN  ( NP, NV )   !  input values
        REAL   , INTENT(IN   ) :: WL50             !  50 Percent filtered wavelength  (KM)
        REAL   , INTENT(  OUT) :: GRID(  NG )      !  output values
        REAL   , INTENT(  OUT) :: GRIDN( NG, NV )  !  output values
 
</PRE><P>    

<H2> C version: </H2>

    <BLOCKQUOTE>
    There isn't one; however, you can usually call these routines
    from C if you do it right (all arguments pass by reference; the
    C caller will see the subroutine as &quot;void cbarnes1_&quot;
    (etc.) under most UNIX systems, &quot;void cbarnes1&quot; for
    IBM AIX or HP HP-UX, or &quot;void CBARNES1&quot; for Crays.)
    </BLOCKQUOTE>
    <P> 

<H2> Summary: </H2>

    <BLOCKQUOTE>
    <VAR>CBARNES1()</VAR> grids one variable <VAR>Z</VAR> and
    <VAR>CBARNESN()</VAR> grids an array of variables <VAR>ZN</VAR>,
    from locations with lat-lon coordinates 
    <VAR>&lt;YLAT(1...NP),XLON(1...NP)&gt;</VAR> and produce output
    array <VAR>GRID(1...NG)</VAR> or <VAR>GRIDN(1...NG,1...NV)</VAR> at
    the locations  <VAR>&lt;LAT(1...NG),LON(1...NG)&gt;</VAR>.  For
    gridding purposes, <VAR>NG</VAR> should be <VAR>NCOLS*NROWS</VAR>;
    the <VAR>CBARNES</VAR> routines will regard the corresponding output
    array as single indexed in the first subscript.
    <P> 

    These routines are an extension of a spatial analysis technique with
    scale dependent filtering that was originally proposed by Stanly
    Barnes in 1964 and was expanded in 1973.  The scale dependent
    response function of the filtering effect is analytically
    calculable and can be adjusted by the choice of two parameters in
    the Gaussian weighting function used.
    <P> 

    Input data point locations should be specified in latitude and
    longitude degrees.  The separation distances between these data
    points and the grid points where the estimates are made is
    calculated from a function that is determined by spherical geometry
    under the assumption of a spherical Earth.
    <P> 

    These routines were modified by Carlie Coats from routines
    originally produced for the EPA Regional Oxidant Model and 
    adapted also for UAM BEIS.  They use &quot;exact&quot;
    spherical-geometry distance formulas instead of the
    &quot;flat-earth&quot; approximations used earlier, as well
    as correct calculation of residuals instead of the earlier
    incomplete linear-interpolation approximation of the residuals.
    <P> 

    Note that there are not explicit <VAR>MODULE M3UTILIO</VAR>
    <CODE>INTERFACE</CODE>s for these routines, because of the
    single-indexing frequently employed by their callers.
    </BLOCKQUOTE>
    <P> 


<H2> Fortran Usage: </H2>
 
    <VAR>!! Under construction !!</VAR>
    

<HR> <!----------------------------------------------------------------->
    
<A HREF = "CSTRINGS.html" >
Previous:  <STRONG>C/Fortran String Conversion</STRONG>
</A><P> 

<A HREF = "DSCGRID.html" >
Next:  <STRONG>DSCGRID</STRONG>
</A><P> 

<A HREF = "AA.html#coordstuff"> 
Up: <STRONG>Coordinate and Grid Related Routines</STRONG> 
</A><P>

<A HREF = "AA.html#utility"> 
Up: <STRONG>Utility Routines</STRONG> 
</A><P>

<A HREF = "AA.html"> 
To: <STRONG>Models-3/EDSS I/O API:   The Help Pages</STRONG> 
</A><P>

</BODY>
</HTML>

