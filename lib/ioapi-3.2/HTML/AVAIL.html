
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<!-- "$Id: AVAIL.html 138 2019-10-29 21:20:00Z coats $" -->
<META NAME="MSSmartTagsPreventParsing" CONTENT="TRUE">
<TITLE>
    Availability/Download of the BAMS/Models-3 I/O&nbsp;API
</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFFF"
      TOPMARGIN="15"
      MARGINHEIGHT="15"
      LEFTMARGIN="15"
      MARGINWIDTH="15">
<!--#include virtual="/INCLUDES/header.html" -->
<H1>
    Availability/Download/Installation of the EDSS/Models-3 I/O&nbsp;API
</H1>

<H2>
    <A NAME="contents">Contents</A>
</H2>

    <UL>
        <LI>  <STRONG><A HREF = "#build">Build and installation
              instructions</A></STRONG> for I/O&nbsp;API Versions&nbsp;3.0,
              3.1, and 3.2
              <P>
       <LI>  <A HREF = "#v32">I/O&nbsp;API
              Version&nbsp;3.2</A>: download and notes
        <LI>  <A HREF = "#v31">I/O&nbsp;API Version&nbsp;3.1</A>:
              download and notes
        <LI>  <A HREF = "#v30">I/O&nbsp;API Version&nbsp;3.0</A>:
              download and notes
        <LI>  <A HREF = "#v22">I/O&nbsp;API Version&nbsp;2.2</A>
        <LI>  <A HREF = "#v21">I/O&nbsp;API Version&nbsp;2.0 and 2.1</A>
               <P>
        <LI>  <STRONG><A HREF = "#cmaq">NOTE for users of
              <VAR>CMAQ</VAR> and <VAR>SMOKE</VAR> </A></STRONG>
              <P>
        <LI>  <STRONG><A HREF = "#win64">NOTES on <VAR>CygWin</VAR>
              under MS Windows</A></STRONG>
              <P>
        <LI>  <STRONG><A HREF = "#ncf4">NOTES on <VAR>netCDF</VAR> Version&nbsp;4</A></STRONG>
              <P>
        <LI>  <STRONG><A HREF = "#gfort">NOTES on <VAR>gfortran</VAR></A></STRONG>
              <P>
        <LI>  <STRONG>Users of Portland Group <VAR>pgf90</VAR> under
              Linux, <A HREF="ERRORS.html#pgi"><EM><U>please read
              this!</U></EM></A></STRONG>
              <P>
        <LI>  <STRONG><A HREF = "#medium">Notes on <CODE>Linux2_x86_64</CODE>
              memory models</A></STRONG>
              <P>
        <LI>  <STRONG><A HREF = "#large"><VAR>netCDF</VAR> and Large Files</A></STRONG>
              <P>
        <LI>  <STRONG><A HREF = "#warn">Other Notes and Warnings</A></STRONG>
              <P>
         <LI>  Release Notes&nbsp;/ Change Log are
              <A HREF="NEWSTUFF.html">available here.</A>
              <P>
         <LI> <A HREF="ERRORS.html">I/O API Troubleshooting</A> Document
              <P>
        <LI>  <A HREF = "#note">NOTE on File Types</A>
        <LI>  <A HREF = "#disc">DISCLAIMER</A>
        <LI>  <A HREF = "#docs">Note on I/O&nbsp;API Documents</A>
    </UL>

    Back to the <STRONG><EM><A HREF = "AA.html">I/O&nbsp;API User Manual</A></EM></STRONG>
    <P>


<HR> <!----------------------------------------------------------------->

<H2>
Foreword
</H2>

    <BLOCKQUOTE>
    <STRONG>
    Please read <A HREF = "NOTICES.html">the copyright, licensing, and
    acknowledgements page</A>:  The I/O&nbsp;API library is available
    under the <A HREF = "LGPL.txt">Lesser Gnu Public License,
    version&nbsp;2.1</A>; the &quot;tool&quot; and example programs are
    available under the <A HREF = "gpl.txt">Gnu Public License,
    version&nbsp;2</A>.
    <P>
    The <A HREF = "NEWSTUFF.html#contents">What's New page</A>
    documents bug-fixes, new features, new compiler-support,
    etc.
    </STRONG>
    <P>
    Note that a large amount of effort has been expended during the
    whole of I/O&nbsp;API development to ensure upward compatibility:
    programs written for the original Version&nbsp;0.9 pre-release of
    November, 1992 should still work correctly with the latest
    (August&nbsp;2014) I/O&nbsp;API Version&nbsp;3.1, unlike some other
    software we will refrain from naming here.  There are very few
    upward compatibility issues between Versions&nbsp;3.1 and 3.2,
    mostly coming from the renaming and generalization of
    <CODE>MODULE&nbsp;MATXATTS</CODE> as
    <CODE>MODULE&nbsp;MODATTS3</CODE>.
    <P>

    In general, you are best off if you can build your whole modeling
    system (<VAR>libnetcdf.a</VAR>, <VAR>libpvm3.a</VAR>,
    <VAR>libioapi.a</VAR>, and your model(s)  <VAR>CMAQ</VAR>,
    <VAR>SMOKE</VAR>, etc. with a common compiler set and common set of
    compile-flags.
    <P>

    If you run into troubles with I/O&nbsp;API related programs, it is
    useful to know the versions of all the software components.  The
    CVS-related program <VAR>ident</VAR> can report to you versioning
    keywords in the various components of source, object, library, or
    executable files. For example:
    <PRE>
% cd $HOME/apps/$BIN
% ident init3.o
init3.o:
     &#36;Id:: init3.F 1 2014-03-14 20:22:54Z coats                  &#36;
% ident libioapi.a
libioapi.a:
     &#36;Id:: init3.F 1 2014-03-14 20:22:54Z coats                  &#36;
     &#36;Id:: m3utilio.f 30 2014-08-07 14:34:44Z coats              &#36;
% ident m3stat
m3stat:
     &#36;Id:: m3stat.f 1 2014-03-14 20:22:54Z coats                   &#36;
     &#36;Id:: init3.F 1 2014-03-14 20:22:54Z coats                    &#36;
     &#36;Id: @(#) netcdf library version 3.6.1 of Feb  7 2014 15:05:22 &#36;
    </PRE>
    </BLOCKQUOTE>

    Go to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!----------------------------------------------------------------->

    <H3><A NAME="build">Build and installation instructions</A>
               for I/O&nbsp;API Versions&nbsp;3.0, 3.1, and 3.2</H3>

    <BLOCKQUOTE>
    As of this writing (June&nbsp;2019), I/O&nbsp;API Versions 2.2 and
    earlier are obsolete; 3.0 and 3.1 obsolescent, in critical-fixes-only
    mode; and 3.2 is the current stable/production version.  See the
    <A HREF = "NEWSTUFF.html">Change Log&nbsp;/&nbsp;&quot;What's
    New&quot;&nbsp;/&nbsp;Research Directions</A> page for further
    information.
    <P>
    <DL>
        <DT>  <STRONG>To set up the installation:</STRONG>
        <DD>  <OL>
                  <LI> Download the <EM>gzip</EM>ped tar-file
                       of the source code for the version you want
                       from the CMAS web-site:<BR>
                       <A HREF="https://www.cmascenter.org/ioapi/download/ioapi-3.2.tar.gz"><VAR>ioapi-3.2.tar.gz</VAR></A><BR>
                       <A HREF="https://www.cmascenter.org/ioapi/download/ioapi-3.1.tar.gz"><VAR>ioapi-3.1.tar.gz</VAR></A><BR>, or
                       <A HREF="https://www.cmascenter.org/ioapi/download/ioapi-3.0.tar.gz"><VAR>ioapi-3.0.tar.gz</VAR></A>.<BR>
                       It contains directories <CODE>ioapi</CODE> for
                       the I/O&nbsp;API library source code,
                       <CODE>HTML</CODE> for the documentation,
                       <CODE>m3tools</CODE> for the related tool
                       programs, and for version&nbsp;3.0,
                       <CODE>iotest</CODE> for various test-programs for
                       I/O&nbsp;API developers, and <CODE>notcdf</CODE>
                       for the NCEP <VAR>libnotcdf.a</VAR> library (a
                       dummy library for installation sites that don't
                       allow <VAR>netCDF</VAR> on-site).
                       <P>
                       For CMAQ-DDM, <VAR>ioapi-3.2-large</VAR> has
                       expanded maximum-number-of-files and
                       maximum-variables-per-file parameter-values.
                       <STRONG>This version should be kept carefully
                       isolated from the regular version of the
                       I/O&nbsp;API, and should be used only for
                       CMAQ-DDM and CMAQ-ISAM.  It can be downloaded
                       from the CMAS web-site:<BR>
                       <A HREF="https://www.cmascenter.org/ioapi/download/ioapi-3.2-large.tar.gz"><VAR>ioapi-3.2-large.tar.gz</VAR></A><BR>
                       </STRONG>
                       <P>
                       Version&nbsp;3.2 is also available on GitHub from
                       <A HREF="https://github.com/cjcoats/ioapi-3.2"><VAR>&lt;https://github.com/cjcoats/ioapi-3.2&gt;</VAR></A>.
                       To install a copy of this source code from
                       GitHub, go to the directory under which do the
                       installation, (This directory will be the
                       <CODE>BASEDIR</CODE> for subsequent steps in the
                       installation.) and then do the command
    <PRE>
    git clone https://github.com/cjcoats/ioapi-3.2
    </PRE>
                  <P>
                  <LI> <STRONG>If you downoaded a
                       <VAR>ioapi-*.tar.gz</VAR></STRONG>:<BR>
                       <EM>cd</EM> to the directory under which you wish
                       to build the I/O&nbsp;API. <EM>gunzip</EM> and
                       untar it (<VAR>gtar&nbsp;xvfz&nbsp;ioapi-3.1.tar.gz</VAR>
                       [etc...] does this in one operation).<BR>
                       <STRONG>This directory will be the <CODE>BASEDIR</CODE>
                       for subsequent steps in the installation.</STRONG>
                  <P>
                  <LI> <EM>NOTE: <CODE>Makefile</CODE>,
                       <CODE>ioapi/Makefile</CODE>, and
                       <CODE>m3tools/Makefile</CODE> </EM> will need to
                       be customized for your particular installation.
                       Make sure you back them up when you do this.<BR>
                       For I/O&nbsp;API 3.2, these are no longer in the
                       <CODE>tar</CODE>-file; for previous versions,
                       note that  the untar-operation above will undo
                       your customization. <P>
                       You will need to copy the relevant <CODE>Makefile.*</CODE>
                       templates to <CODE>Makefile</CODE> in the
                       <VAR>${BASEDIR}/ioapi</VAR> and
                       <VAR>${BASEDIR}/m3tools</VAR> directories.  For
                       most users, you want to start with
                       <CODE>Makefile.nocpl</CODE>.
                       <P>
                       In particular, you will need to customize
                       <VAR>make</VAR>-variables <CODE>BASEDIR</CODE>
                       in all <VAR>Makefile</VAR>s, and <CODE>LIBS</CODE>
                       in  <VAR>m3tools/Makefile</VAR> to deal with
                       <A HREF="#ncf4">netCDF-4 library issues.</A>
                       For MS-Windows/Cygwin systems using the Cygwin
                       netCDF libraries, you will need to change the
                       <VAR>m3tools/Makefile</VAR> library-names slightly, from
                       <CODE>-lnetcdff&nbsp;-lnetcdf</CODE> to
                       <CODE>-lnetcdff.dll&nbsp;-lnetcdf.dll</CODE>,
                       as well as not using the flag  <CODE>-fsecond-underscore</CODE>
                       in the <VAR>Makeinclude.${BIN}</VAR>.
                       <P>
                       Note that the <CODE>Makefile</CODE>s and
                       environment-variable <CODE>BIN</CODE>-structure
                       support the simultaneous building and maintenance
                       of multiple versions of both
                       the I/O&nbsp;API and <VAR>m3tools</VAR> programs
                       using the <CODE>bins</CODE>, <CODE>bins</CODE>,
                       <CODE>binclean</CODE>, <CODE>bindirs</CODE>, and
                       <CODE>binrelink</CODE> <VAR>make</VAR>-targets,
                       which may be customized to support the versions
                       you want.
                       Examples of such versions (each of which has its
                       own <CODE>Makeinclude.${BIN}</CODE>) are:
                       <UL>
                            <LI> Choice of compilers
                            <LI> Choice of different compiler-options
                                 (optimized, debug, profiling)
                            <LI> Choice of <A HREF = "#medium">memory
                                 model</A>: <EM>small</EM> (normal) vs
                                 <EM>medium</EM>
                            <LI> &quot;normal&quot; vs global-climate vs
                                 <VAR>pnetCDF/MPI</VAR>
                                 distributed-output vs coupling-mlode
                       </UL>
                       <STRONG>Intel-compiler Warning:</STRONG>  For
                       whatever reason, Intel has chosen to change some
                       flags from version to version, making it
                       difficult to have generic
                       <VAR>Makeinclude.*ifort*</VAR> files. In
                       particular, you will need to edit those files
                       so that <VAR>make</VAR>-variables
                       <CODE>OMPFLAGS</CODE> AND <CODE>OMPLIBS</CODE>
                       use the following:
                       <UL>
                        <LI> For compiler-versions 15  and earlier: 
                             <CODE>-openmp</CODE>
                        <LI> For compiler-versions 16-18 
                             <CODE>-qopenmp</CODE> is preferred, but
                             <CODE>-openmp</CODE> is accepted (with a
                             warning-message)
                        <LI> For compiler-version 19 and later: 
                             <CODE>-qopenmp</CODE>
                       </UL>
                       <P>
                       Note that if you update the I/O&nbsp;API library, then
                       <VAR>cd ../m3tools; make relink</VAR> will
                       efficiently re-build the <VAR>m3tools</VAR>
                       programs.
                       <P>
                       Additional definitions in <VAR>make</VAR>-variable
                       <CODE>DEFINEFLAGS</CODE> (in <VAR>Makefile</VAR>
                       or<CODE>ARCHFLAGS</CODE> (in <VAR>Makeinclude.${BIN}</VAR>
                       turn on various optional capabilities:
                       <BLOCKQUOTE>
                       <DL>
                            <DT> <CODE>-DIOAPI_NO_STDOUT=1</CODE>
                            <DD> suppresses write-operations to the screen
                                 in routines <CODE>INIT3(), M3MSG2(), M3MESG(),
                                 M3ABORT()</CODE>.
                            <DT> <CODE>-DIOAPICPL=1</CODE>
                            <DD> turns on (PVM based) I/O&nbsp;
                                <A HREF="BUFFERED.html#pvm"><U><VAR>coupling
                                 mode</VAR></U></A>.
                            <DT> <CODE>-DIOAPI_SNOOP=1</CODE>
                            <DD> turns on <A HREF="BUFFERED.html#snoop"><U><VAR>snoop
                                 mode</VAR></U></A> for read-operations:
                                 iff timestep-flag not available, sleep
                                 for <CODE>SNOOPSECS3</CODE> seconds.
                                 then re-try, for up to
                                 <CODE>SNOOPTRY3</CODE> attempts.<BR>
                                 <EM>for I/O&nbsp;API-3.2 and later only</EM>
                            <DT> <CODE>-DIO_360=1, -DIO_365=1</CODE>
                            <DD> create the 360-day or 365-day <U><VAR>global climate</VAR></U>
                                 versions of the library<BR>
                                 <EM>365-day version for I/O&nbsp;API-3.2 and later
                                 only</EM>
                            <DT> <CODE>-DIOAPI_PNCF=1</CODE>
                            <DD> turns on <A HREF="BUFFERED.html#pncf"><U><VAR>PnetCDF/MPI
                                 distributed-file mode</VAR></U></A><BR>
                                 <EM>for I/O&nbsp;API-3.2 and later only</EM>
                            <DT> <CODE>-DIOAPI_NCF4=1</CODE>
                            <DD> turns on netCDF-4 <CODE>INTEGER*8</CODE> operations,
                                 and requires HDF-enabled netCDF-4 libraries, instead of
                                 netCDF-3 (for the rest of your
                                 <VAR>Makefile</VAR>s).<BR>
                                 <STRONG>Required if your netCDF library is
                                 built without the recommended
                                 <CODE>--disable-netcdf-4</CODE></STRONG>
                       </DL>
                       </BLOCKQUOTE>
                       <P>
                       You may also need to customize the <CODE>Makeinclude.*</CODE>
                       configuration-files for the configurations) you
                       want to build.  It may be useful to make a new
                       copy with its own <CODE>${BIN}</CODE> extension,
                       so that your changes don't get wiped out if you
                       do an update&mdash;e.g.,
                       <BLOCKQUOTE>
                       <VAR>
                       cp Makeinclude.Linux2_x86_64ifort Makeinclude.Linux2_x86_64intel<BR>
                       setenv BIN Linux2_x86_64intel<BR>
                       ...
                       </VAR>
                       </BLOCKQUOTE>
                       This is especially true of PnetCDF enabled
                       I/O&nbsp;API configurations (below), for which
                       the names (etc.) of the MPI based compilers are
                       highly dependent upon the details of individual
                       installations.  Note that there are already a
                       number of specialized
                       <CODE>Makeinclude.${BIN}</CODE>s
                       for various purposes; they should serve as
                       templates if you need these capabilities for
                       different compilers:
                       <BLOCKQUOTE>
                       <DL "COMPACT">
                           <DT><CODE>Makeinclude.*dbg</CODE>
                           <DD>Debug version of library
                           <DT><CODE>Makeinclude.*360</CODE>
                           <DD>360-day (no leap-year) climatology-year version of library
                           <DT><CODE>Makeinclude.*365</CODE>
                           <DD>365-day (no leap-year) climatology-year version of library
                           <DT><CODE>Makeinclude.*MPI</CODE>
                           <DD>PnetCDF/MPI enabled distributed-I/O version
                           of library
                           <DT><CODE>Makeinclude.*_medium*</CODE>
                           <DD>medium-memory-model (large stack/large-array)
                               version of library
                       </DL>
                       </BLOCKQUOTE>
                       <P>
                       Note also that starting with their
                       Version&nbsp;16 (and later) compilers, Intel has
                       introduced a new compiler directive
                       <CODE>-qopenmp</CODE> to enable OpenMP, and has
                       deprecated the previous <CODE>-openmp</CODE>
                       (which now results in a "deprecated flag"
                       warning).<BR>
                       <EM>I/O&nbsp;API-3.2 only:</EM> Changing the
                       <CODE>OMPFLAGS</CODE>  and  <CODE>OMPLIBS</CODE>
                       <VAR>make</VAR>-variables in the
                       <CODE>Makeinclude.*ifort*</CODE> to match this
                       compiler-change (as indicated in the comments)
                       can eliminate this compile warning for current
                       Intel compilers.
                  <P>
                  <LI> If you want to <STRONG>disable the
                        <A HREF="BUFFERED.html#pvm">coupling-mode</A>
                        configuration</STRONG> (which is enabled by
                        default), <EM>cd&nbsp;ioapi</EM>  and then
                        <EM>cp&nbsp;Makefile.nocpl&nbsp;Makefile</EM>
                        and customize it, and similarly for the
                        <EM>m3tools</EM> directory.
                  <P>
                  <LI> <EM>I/O&nbsp;API 3.2 only:</EM> If you want to enable
                        the <A HREF="BUFFERED.html#pncf">PnetCDF
                        distributed I/O</A> configuration (for CMAQ),
                        <EM>cd&nbsp;ioapi</EM>  and then
                        <EM>cp&nbsp;Makefile.pncf&nbsp;Makefile</EM>
                        and <VAR>setenv</VAR> environment variable
                        <CODE>BIN</CODE> to one of the supported
                        distributed-I/O types
                        <CODE>Linux2_x86_64gfortmpi,
                        Linux2_x86_64ifortmpi,Linux2_x86_64pgmpi,
                        Linux2_x86_64sunmpi  </CODE>
                        <BR>
                        <EM><STRONG>NOTES</STRONG></EM>
                        <OL>
                            <LI> <STRONG>PnetCDF enabled I/O&nbsp;API
                                 libraries are not compatible with
                                 &quot;normal&quot; libraries.</STRONG>
                                 Make sure you keep them separate.<BR>
                                 <STRONG>You will want to build
                                 both</STRONG>, since the PnetCDF
                                 enabled libraries are for CMAQ only.
                            <LI> What is called <VAR>mpif90</VAR> is
                                 really a script that understands about
                                 an underlying compiler-set (e.g., Intel
                                 <VAR>ifort/icc</VAR>, PGI
                                 <VAR>pgf90/pgcc</VAR>, etc.), a set of
                                 (MPI-installation specific)
                                 <CODE>INCLUDE</CODE> files, and a set
                                 of<CODE>$quot;.a&quot;</CODE>
                                 library-files. <STRONG>These are not
                                 compatible from MPI-implementation to
                                 MPI-implementation (OpenMPI, MVAPICH,
                                 etc.) nor from underlying compiler-set
                                 to underlying compiler-set</STRONG>.
                            <LI> There may even be compatibility
                                 problems between different versions of
                                 the &quot;same&quot; implementation:
                                 This author has found that
                                 <STRONG>OpenMPI-1.4.x is not even
                                 source-code  compatible with
                                 OpenMPI-1.6.x&nbsp;;-(</STRONG>
                            <LI> This part of the I/O&nbsp;API source code
                                 had to be hacked badly to deal with the above.
                        </OL>
                  <P>
                  <LI> If you want to enable the <STRONG>360-day or
                        365-day (no-leap-year) climatology year
                        configuration</STRONG> (365-day for
                        <EM>I/O&nbsp;API 3.2 only</EM>), customize your
                        <VAR>ioapi/Makefile</VAR> by adding
                        <CODE>-DIO_360=1</CODE> or
                        <CODE>-DIO_365=1</CODE> respectively to the
                        <CODE>DEFINEFLAGS</CODE>
                        <VAR>make</VAR>-variable. <BR>
                        <EM>Note that you need to keep the resulting
                        libraries separate from the normal (leap-year
                        enabled) libraries.</EM>
                 <P>
                  <LI>  For each desired configuration of machine,
                        compiler-set, and other options,
                        <STRONG><VAR>setenv&nbsp;BIN&nbsp;&lt;type&gt;</VAR></STRONG>,
                        where <CODE>&lt;machinetype&gt;</CODE> matches
                        the extension on one of the
                        <CODE>ioapi/Makeinclude.*</CODE> (creating a new
                        one, if necessary).  Then do a top-level
                        <VAR>make&nbsp;dirs</VAR> to build the
                        object-directories.
                        <P>
                        The usual pattern for generating <CODE>BIN</CODE> is
              <BLOCKQUOTE>
              <VAR>setenv BIN  `uname -s``uname -r | cut -d. -f1`</VAR>
              </BLOCKQUOTE>
                        and then modify the result by appending any
                        compiler specifics, e.g., for F90, debug- or
                        profile-compiled configurations.
                        <P>
                        A list of the &quot;standard&quot; supported
                        platforms <A HREF="LIBS.html#platforms">can
                        be found here.</A>
                        <P>
                        Linux versions 2, 3, and 4 are binary-compatible,
                        so <CODE>Linux2</CODE> is used for all of these
                        (and similarly for recent versions of <CODE>SunOS</CODE>).
                        <P>
                        Note,  for example,
                        that for <CODE>Linux2_x86*</CODE>, there are
                        distinct (and incompatible) variants for the
                        GNU <VAR>gfortran/gcc</VAR>, Intel <VAR>ifort/icc</VAR>,
                        Lahey-Fujitsu <VAR>lf95</VAR>/GNU <VAR>gcc</VAR>,
                        and Portland Group <VAR>pgf90/pgcc</VAR>;
                        <STRONG>moreover, the latter is not compatible with
                        Portland Group <VAR>pgf90</VAR>/GNU
                        <VAR>gcc</VAR> (when the latter is used to
                        build <VAR>libnetcdf.a</VAR>, as in the vendor
                        supplied libraries on RedHat</STRONG> <EM>(that
                        incompatibility being the largest single
                        generator of installation-questions in recent
                        years!).</EM>
                        <P>
                        <EM><STRONG>INTEL and SGI NOTES:</STRONG>
                         <UL>
                           <LI> At some point in its 8.0.x sequence of
                                compiler versions, Intel has changed the
                                names of its compilers:  <VAR>ecc</VAR>
                                becomes <VAR>icc</VAR> for the Itanium (IA64)
                                platform, and both   <VAR>efc</VAR> and
                                <VAR>ifc</VAR> become <VAR>ifort</VAR>; you
                                may need to edit v3.0 and earlier
                                <CODE>Makeinclude.$BIN</CODE>
                                accordingly.
                           <LI> There are problems with the Fortran
                                pre-processing for some versions of the
                                Intel Fortran compilers;  these can to
                                some extent alleviated by separating
                                the preprocessing from the compile step
                                for the <CODE>*.F</CODE> files.
                                <VAR>Makefile.cpphack</VAR> is a sample
                                <VAR>Makefile</VAR> for this purpose
                                (as provided, it assumes OpenMP and
                                coupling mode).
                           <LI> There are problems with SGI
                                <VAR>f90</VAR> Version&nbsp;7.4.  Use
                                Version&nbsp;7.4.1 or later instead.
                           <LI> There are command line incompatibilities
                                between SGI <VAR>f90</VAR> Version&nbsp;7.3.x
                                and 7.4.1; for 7.3.x, you need to edit the
                                <CODE>MAKEINCLUDE.$BIN</CODE> to replace
                                <CODE>-TARG:platform=ip27 -TARG:processor=r12000</CODE>
                                by <CODE>-TARG:platform=ip27,processor=r12000</CODE>,
                                (etc.)
                        </UL>
                        </EM>

                  <P>
                  <LI>  Acquire and build the netCDF library,
                        <VAR>libnetcdf.a</VAR> (and <VAR>libnetcdff.a</VAR>
                        for netCDF-4.1 or later), for each configuration.
                        The netCDF home page is
                        <A HREF="https://www.unidata.ucar.edu/software/netcdf/">
                        https://www.unidata.ucar.edu/software/netcdf/</A>
                        For each configuration,copy or link the resulting
                        <VAR>libnetcdf.a</VAR> (and <VAR>libnetcdff.a</VAR>,
                        if you're building netCDF version 4.1 or later)
                        to the appropriate object
                        directory <CODE>$BASEDIR/$BIN</CODE>.
                        <P>
                        <STRONG>For I/O&nbsp;API-3.2 and
                        netCDF-4:</STRONG>  Some configurations of
                        netCDF-4 have <CODE>INTEGER*8</CODE> (64-bit
                        integer) support, and some do not; the I/O&nbsp;API
                        tries to make it possible to use this support if
                        it is available, but needs to include
                        &quot;hacks&quot; to cover for its absence when
                        it isn't.  You can find out if it is included in
                        netCDF using the command
                        <PRE>
        nm libnetcdff.a | grep nf_get_var_int64_
                        </PRE>
                        If present, you need to add the definition
                        <CODE>-DIOAPI_NCF4=1</CODE> to the 
                        <VAR>make</VAR>-variable <CODE>ARCHFLAGS</CODE> 
                        in your <CODE>MAKEINCLUDE.${BIN}</CODE>. 
                        Otherewise, you will get &quot;multiply defined
                        symbol&quot; errors when you attempt to compile
                        programs.
                        <P>
                        For I/O&nbsp;API-3.2, if you are building the
                        PnetCDF/MPI distributed-I/O version for CMAQ,
                        then install the appropriate MPI development
                        package, and download PnetCDF from
                        <A HREF="https://trac.mcs.anl.gov/projects/parallel-netcdf/wiki/Download">https://trac.mcs.anl.gov/projects/parallel-netcdf/wiki/Download</A>
                        then build and install <VAR>libpnetcdf.a</VAR> and
                        copy or link it to the appropriate object
                        directory.<BR>
                        Note that to a very large extent,
                        <STRONG>different MPI implementations are not
                        compatible</STRONG>:  Intel MPI does not play
                        well with OpenMPI does not play well with MPICH
                        does not play well with MVAPICH...&nbsp;;-(
                        <P>
                        If you plan to build a
                        <A HREF="BUFFERED.html#pvm">coupling-mode
                        configuration</A>, do the same with PVM's
                        <VAR>libpvm3.a</VAR>. See
                        <A HREF="http://www.csm.ornl.gov/pvm/pvm_home.html">
                        http://www.csm.ornl.gov/pvm/pvm_home.html</A>
                        (Only the C interface to PVM is used; the resulting
                        library tends to be more compiler-independent than
                        for netCDF, where both C and Fortran interfaces
                        are used.)
                  <P>
                  <LI>  Edit the relevant files
                        <VAR>ioapi/Makeinclude.$BIN</VAR> for your
                        system specific compiler options, PVM
                        installation location, etc., or create new ones,
                        as appropriate.
                  <P>
                  <LI>  Edit the <VAR>Makefile</VAR>s to set
                        <VAR>make</VAR>-variable <CODE>BASEDIR</CODE>,
                        etc., for your system.
                        <P>
                        If you are doing a multi-configuration
                        installation, do the same for each
                        <VAR>*/Makefile*</VAR>.
                        <P>
                        If you are doing a single-configuration
                        installation, you may customize
                        <VAR>make</VAR>-variables in the top level
                        <VAR>Makefile</VAR> and do the following
                        from the top level directory as a
                        short-cut:
                        <BLOCKQUOTE><CODE>
                        make configure<BR>
                        make dir<BR>
                        [cd ../${BIN} and copy in the needed netCDF etc.
                        libraries]<BR>
                        cd ..<BR>
                        make<BR>
                        </CODE></BLOCKQUOTE>
                  <P>
                  <LI>  <VAR>setenv&nbsp;BIN&nbsp;...</VAR>, followed by
                        one of the <VAR>make&nbsp;&lt;target&gt;</VAR>
                        commands below,  as appropriate for your
                        configuration(s).<BR>
                        Alternatively, <STRONG><VAR>make&nbsp;BIN=&lt;machinetype&gt;</VAR></STRONG>
                        (where note that a command-line
                        variable-definition overrides the environement
                        variable definition).
                  <P>
                  <LI>  Note that a top-level <VAR>make</VAR> will
                        generate messages about installing the
                        <VAR>notCDF</VAR> library.  Almost all users
                        can ignore these messages;
                        <VAR>libnotcdf.a</VAR> is only required at NCEP,
                        where it is politically forbidden to have any
                        copy of <VAR>libnetcdf.a</VAR> on the system.
              </OL>
        <P>
        <DT>  <STRONG>Top-Level <VAR>make</VAR> targets include the
              following:</STRONG>
        <DD>  <DL "COMPACT">
                  <DT><STRONG><CODE>make dir</CODE></STRONG>
                  <DD>  Construct the build-directory <CODE>$OBJDIR</CODE>
                        You only need to do this once for each
                        configuration <CODE>$BIN</CODE>
                  <DT><STRONG><CODE>make all</CODE></STRONG>
                  <DD>  Build all libraries and executables (assumes
                        the Fortran compiler is Fortran-90 compliant)
                        for the default mode.
                  <DT><STRONG><CODE>make cpl</CODE></STRONG>
                  <DD>  Build all libraries and executables for
                        PVM-enabled  coupling mode.
                  <DT><STRONG><CODE>make nocpl</CODE></STRONG>
                  <DD>  ... for no-PVM no-coupling mode.  <EM>This is
                        probably the best target for regulatory
                        users who need multiple configurations.</EM>
                  <DT><STRONG><CODE>make relink</CODE></STRONG>
                  <DD>  Rebuild all the <CODE>M3TOOLS</CODE> executables,
                        using the existing <CODE>M3TOOLS</CODE> object
                        files (e.g.,if you have changed the libraries).
                  <DT><STRONG><CODE>make clean</CODE></STRONG>
                  <DD>  removes all executable, object (<CODE>.o</CODE>),
                        and library (<CODE>.a</CODE>) files.
                  <DT><STRONG><CODE>make configure</CODE></STRONG>
                  <DD>  allows you to set up <VAR>make</VAR>-parameters
                        in the top-level <CODE>Makefile</CODE> and
                        then run a set of <VAR>sed</VAR> commands
                        on the templates <CODE>*/Makefile*.sed</CODE>
                        in order to generate lower level
                        <CODE>Makefile</CODE>s for a particular
                        configuration.<BR>
                        <STRONG>Writes over any existing
                        <CODE>Makefile</CODE> customizations!</STRONG>
                  <DT><STRONG><CODE>make bins</CODE></STRONG>
                  <DD>  builds everything for several choices
                        of (Linux) architectures and compilers.
                        <BR>
                        <EM>Note:  easily customized for your system.</EM>
                  <DT><STRONG><CODE>make binclean</CODE></STRONG>
                  <DD>  cleans everything for several choices
                        of architectures and compilers.
                  <DT><STRONG><CODE>make fix</CODE></STRONG> or<BR>
                        <STRONG><CODE>cd ioapi; make fixed_src</CODE></STRONG>
                  <DD>  builds pre-version-5.0-CMAQ and SMOKE &quot;fixed-132&quot;
                        non-ISO-Standard Fortran source form <CODE>INCLUDE</CODE>-files
                        and places them in directory
                        <CODE>${BASEDIR}/ioapi/fixed_src/</CODE>.
              </DL>
        <P>
    </DL>
    </BLOCKQUOTE>
    <P>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!----------------------------------------------------------------->

    <H3><A NAME="gfort">NOTES on <VAR>gfortran</VAR></A></H3>

    <BLOCKQUOTE>
    GNU  <VAR>gfortran</VAR> seems to be insistent upon incompatibility:
    not only incompatibility with existing industry standards, but even
    inconsistency with itself from version to version.  In some cases,
    not even <CODE>Makefile</CODE> will continue to work from one
    version to the next.  At this time, <VAR>gfortran</VAR> should be
    used only with trepidation.
    <BR>
    --Carlie J. Coats, Jr., Ph.D.<BR>
    I/O&nbsp;API author
    <P>

    <DL>

	<DT><STRONG>Finding <CODE>MODULE</CODE> files</STRONG>
	<DD>
	Fortran compilers use various ways to find directories
	containing &quot;module files&quot; such as the I/O&nbsp;API's
	<VAR>m3utilio.mod</VAR>.
	Suppose the I/O API's <CODE>OBJDIR</CODE> is something like
	<VAR>/foo/bar/$BIN</VAR>.  Then for most F90 compilers, the way
	to tell the compiler to search that directory for module files
	is to use the following as a compiler-flag:
	<BLOCKQUOTE><CODE>
	-I/foo/bar/$BIN
	</CODE></BLOCKQUOTE>.
	Some other compilers (e.g., Sun, Absoft, older versions of
	<VAR>gfortran</VAR>) use
	<BLOCKQUOTE><CODE>
	-M/foo/bar/$BIN
	</CODE></BLOCKQUOTE>
or (PGI)
	<BLOCKQUOTE><CODE>
	-module /foo/bar/$BIN
	</CODE></BLOCKQUOTE>.
	Recent versions of <VAR>gfortran</VAR> use
	<BLOCKQUOTE><CODE>
	-J /foo/bar/$BIN
	</CODE></BLOCKQUOTE>.
	Needless to say, this makes it more difficult to write <VAR>Makefile</VAR>s ;-(
	<P>

	<DT><STRONG><CODE>IARGC</CODE> and
	<CODE>COMMAND_ARGUMENT_COUNT</CODE>,
	etc.</STRONG>
	<DD>
	Recent versions of <VAR>gfortran</VAR> break compatibility with
	older versions, and with standards such as Mil-Spec 1753, in their
	handling of command line arguments:  they no longer support
	<CODE>IARGC()</CODE> and <CODE>GETARG()</CODE>, insisting rather
	on Fortran-2003 constructs <CODE>COMMAND_ARGUMENT_COUNT()</CODE> and
	<CODE>GET_COMMAND_ARGUMENT()</CODE>.
	<P>

	I/O&nbsp;API file <VAR>init3.F</VAR> now has &quot;hacks&quot; to
	get around this incompatibility:  if preprocessor-symbol
	<CODE>NEED_ARGS</CODE> is defined, it generates
	<CODE>IARGC()</CODE> and <CODE>GETARG()</CODE> in terms of
	<CODE>COMMAND_ARGUMENT_COUNT()</CODE> and
	<CODE>GET_COMMAND_ARGUMENT()</CODE>. By default,
	<VAR>Makeinclude.Linux2_x86</VAR>, and
	<VAR>Makeinclude.Linux2_x86_64</VAR> and
	<VAR>Makeinclude.Linux2_x86_64gfort</VAR> (which specify how to
	build the I/O&nbsp;API (etc.) for 32-bit or 64-bit
	<VAR>gfortran/gcc</VAR>) now define this symbol as part of
	<VAR>make</VAR>-variable <CODE>ARCHFLAGS</CODE>.
	<P>

	If you get &quot;symbol not found&quot; errors when building
	I/O&nbsp;API  programs like those in <VAR>m3tools</VAR>,
	remove this  <CODE> -DNEED_ARGS=1</CODE> from the relevant
	<VAR>Makeinclude</VAR> file.
	<P>

    </DL>

    </BLOCKQUOTE>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>

<HR> <!----------------------------------------------------------------->

    <H3><A NAME="cmaq">NOTE for users of <VAR>CMAQ</VAR> and 
    <VAR>SMOKE</VAR></A></H3>

    <BLOCKQUOTE>
    According to the ISO Fortran Standard, there are two &quot;source
    formats&quot; for Fortran source code -- the older
    (<CODE>f77</CODE>)  &quot;fixed&quot; format with code in columns
    7-72 and continuation markers in column 6, and the
    (<CODE>f90</CODE>) &quot;free&quot; format, with source in columns
    1-132 and ampersand (&quot;&&quot;) for trailing continuation
    markers, as well as a specification for code which is acceptable to
    both forms.
    <P>
    
    Since it is used by various models that use &quot;free&quot; format, 
    the I/O&nbsp;API carefully follows the Standard in this regard, and
    uses the ISO-app[roved &quot;both-form&quot; format for its Fortran
    <CODE>INCLUDE</CODE> files.
    <P>

    Some of the models&mdash;in particular, <VAR>CMAQ</VAR> and 
    <VAR>SMOKE</VAR> however, do not&mdash;instead using a
    &quot;fixed-132&quot; format. The I/O&nbsp;API <VAR>Makefile</VAR>
    has a way of dealing with this; the commands
    <BLOCKQUOTE><VAR>
    cd &lt;installation directory&gt;/ioapi<BR>
    make fixed_src
    </VAR></BLOCKQUOTE>
    will create a new directory <VAR>ioapi/fixed_src</VAR> and populate
    it with copies of the <CODE>INCLUDE</CODE> files that have been
    edited to work with the non-Standard &quot;fixed-132&quot; format.
    You will need to use these <CODE>INCLUDE</CODE> files with
    <VAR>CMAQ</VAR> and  <VAR>SMOKE</VAR>.
    <P>

    <STRONG>ASIDE on FILE EXTENSIONS:</STRONG>
    <BLOCKQUOTE>
    The &quot;industry standard&quot; for Fortran source-file naming is
    that the extensions for file names should be as follows:
    <UL>
        <LI><CODE>.f</CODE> for fixed format Fortran source code
        <LI><CODE>.f90</CODE> for free format Fortran source code
        <LI><CODE>.F</CODE> for fixed format Fortran source code that
            needs to be run through the C pre-processor <VAR>cpp</VAR>
            before compiling (because it uses <CODE>#include</CODE>,
        <CODE>#define</CODE> and that sort of thing)
        <LI><CODE>.F90</CODE> for free format Fortran source code that
            needs to be run through the C pre-processor <VAR>cpp</VAR>
    </UL>
    Virtually all UNIX/Linux Fortran compilers will automatically use
    the file-extension to determine which source form to expect, unless
    you override this expectation with explicit flags specifying
    otherwise.  Sadly, what these flags are varies from compiler to
    compiler.
    <P>
    The <VAR>findent</VAR> program is an excellent resource for
    converting code back and forth between the two forms (and even the
    non-Standard one); see 
    <A HREF="https://sourceforge.net/projects/findent/">
    https://sourceforge.net/projects/findent/</A>.
    <P>

    It is also much more convenient for <VAR>make</VAR> dependencies if
    Fortran <CODE>MODULE</CODE>s are one per file, with file name the
    lower case of the  <CODE>MODULE</CODE> name&mdash;
    <CODE>MODULE&nbsp;MODFOO</CODE> will be in the file named
    <VAR>modfoo.f</VAR> or  <VAR>modfoo.f90</VAR>, as appropriate
    (depending upon source-form).
    <P>
    </BLOCKQUOTE>
    </BLOCKQUOTE>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>

<HR> <!----------------------------------------------------------------->

    <H3><A NAME="win64">NOTES on <VAR>CygWin</VAR> under MS Windows</A></H3>

    <BLOCKQUOTE>
    I/O&nbsp;API Version&nbsp;3.2 can be successfully installed under
    the CygWin64 unix-emulation environment for Microsoft Windows.  You
    will need to make sure you install a good development environment
    with it; fortunately, what you need is available in the Cygwin
    repositories.
    <P>

    My recommendation is to install CygWin64 with at least the following
    additional packages:
    <BLOCKQUOTE><CODE>
    binutils cmake coreutils diffutils dos2unix findutils gcc-core
    gcc-gfortran gcc-g++ gdb git gnuplot grep libcurl-devel libcurl4
    libgd-devel libgd3 libhdf5-devel libhdf5_10 libjpeg-devel libjpeg8
    libnetcdf libnetcdf-devel libnetcdf-fortran libnetcdf-fortran-devel
    libpng16-devel libpng16 libtool netcdf netcdf-fortran ncview openmpi
    tar tcsh tree util-linux vim wget xhost xinit xorg-server xorg-x11-fonts-dpi100
    xterm xxdiff zlib zlib-devel zlib0 
    </CODE></BLOCKQUOTE>
    Note that this installation will include Version 4.4 of the netCDF
    libraries, for both Fortran and C; you will not need to build these
    libraries yourself &quot;from scratch&quot;. On the other hand, when
    you build programs using the I/O&nbsp;API (and therefore netCDF),
    you will need to refer to them a bit differently than normal usage,
    as
    <BLOCKQUOTE><CODE>
    -lnetcdff.dll -lnetcdf.dll
    </CODE></BLOCKQUOTE>
    For example, you will have to edit the definition of
    <CODE>LIBS</CODE> in <VAR>m3tools/Makefile</VAR>:
    <BLOCKQUOTE><CODE>
    LIBS = -L${OBJDIR} -lioapi -lnetcdff.dll -lnetcdf.dll $(OMPLIBS) $(ARCHLIB) $(ARCHLIBS)
    </CODE></BLOCKQUOTE>
    <P>

    The Cygwin64 package list is at 
    <BLOCKQUOTE>
    <A HREF="https://cygwin.com/packages/package_list.html">https://cygwin.com/packages/package_list.html</A>
    </BLOCKQUOTE>
    To install additional packages after the initial installation, open
    the <VAR>File Explorer</VAR> on <VAR>Downloads</VAR> and run
    <VAR>setupx86_64.exe</VAR> found there.  When you get to package
    selection, choose &quot;uninstalled&quot; and pick your selections
    from the menu.
    <P>

    You may also wish to install a GUI editor that understands UNIX line
    conventions (which are different from Windows; Windows
    <VAR>notepad</VAR> screws this up badly).  I've found that the
    <A HREF="http://www.crimsoneditor.com/"><VAR>Crimson Editor</VAR></A>
    is a free and workable choice for such an editor.  (For CygWin
    graphical programs such as the <VAR>nedit</VAR> editor, you will
    need to install and run the X-windows server...)
    <P>
    
     
    <P>

    </BLOCKQUOTE>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>

<HR> <!----------------------------------------------------------------->

    <H3><A NAME="ncf4">NOTE on  <VAR>netCDF</VAR> Version&nbsp;4</A></H3>

    <BLOCKQUOTE>
    <STRONG>
    Evidently, starting with netCDF-Fortran&nbsp;4.4.2, UCAR in their
    wisdom decided to silently eliminate the
    <CODE>CALL&nbsp;NC*()</CODE> Fortran interfaces in terms of which
    the I/O&nbsp;API was originally implemented.  [If you can find any
    documentation indicating this intent on the web, I would enjoy
    seeing it; <EM>I</EM> can't find it.]
    <P>
    I/O&nbsp;API Version&nbsp;3.2 was tediously re-coded to replace all
    943 of these calls by the newer <CODE>IERR=NF_*()</CODE> Fortran
    interfaces that are still supported.  Prior editions of the
    I/O&nbsp;API will have link errors with netCDF-Fortran&nbsp;4.4.2 or
    later, because routines such as <CODE>NCCLOS()</CODE> are no longer
    in that library.
    <P>
    </STRONG>

    NetCDF Version&nbsp;4.x have lots of additional build options,
    that will require a complex set of additional libraries in your
    <STRONG><VAR>Makefile</VAR>s and all other model-building systems</STRONG>.
    It is recommended that you disable these options by adding the
    command-line flags below to your netCDF <VAR>configure</VAR>
    command:
    <BLOCKQUOTE><CODE>
    --disable-netcdf4 --disable-dap
    </CODE></BLOCKQUOTE>
    or (depending upon netCDF version; don't you <EM>love</EM>
    consistency and compatibility !?? )
    <BLOCKQUOTE><CODE>
    --disable-netcdf-4 --disable-dap
    </CODE></BLOCKQUOTE>
    NetCDF Version&nbsp;4.1 and later also split the Fortran
    interfaces into a separate library <VAR>libnetcdff.a</VAR>
    As a result, much compatiblity with the infrastructure
    (<VAR>Makefile</VAR>s, etc.) is broken: you <STRONG>must modify
    all <VAR>Makefile</VAR>s, replacing <CODE>-lnetcdf</CODE> with
    <CODE>-lnetcdff&nbsp;-lnetcdf</CODE></STRONG>.  If you don't
    build netCDF as indicated above, you will need additional libraries
    that may be discovered by running the netCDF commands
    <BLOCKQUOTE>
        <VAR>nc-config --libs</VAR><BR>
        <VAR>nf-config --libs</VAR>
    </BLOCKQUOTE>
    <P>

    <STRONG>
    Starting with I/O&nbsp;API Version&nbsp;3.1 of October&nbsp;11,
    2011, the <VAR>m3tools/Makefile</VAR>s are configured by default to
    use the <CODE>-lnetcdff&nbsp;-lnetcdf</CODE> netCDF-v4-style
    libraries.  If using a previous version of netCDF, you must modify
    them manually.
    <P>
    You must also modify the build-systems for CMAQ, MCIP, SMOKE, and
    all your other models that use netCDF similarly.
    </STRONG>
    <P>

    On the other hand, you may find it much easier to revert to a
    previous edition of netCDF (such as version 3.6.3) and revert
    your <CODE>Makefile</CODE>s and build systems to use just
    <CODE>-lnetcdf</CODE> instead of the <CODE>-lnetcdff&nbsp;-lnetcdf</CODE>
    required by netCDF version 4 and later.
    <P>
    </BLOCKQUOTE>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!----------------------------------------------------------------->

    <H3><A NAME="medium">Notes on <CODE>Linux2_x86_64</CODE>
                         memory models</A></H3>


    <BLOCKQUOTE>
    There are three different binary-incompatible &quot;memory
    models&quot; available for 64-bit <CODE>x86</CODE> Linux:
    <BLOCKQUOTE>
    <DL>
        <DT> <CODE>small</CODE>
        <DD> At most 2 GB each for static data (<CODE>COMMON</CODE>s,
             etc.), <CODE>ALLOCATE</CODE>d arrays, program-stack, and
             program machine-code.
        <P>
        <DT> <CODE>medium</CODE>
        <DD> Program machine-code at most 2 GB; no restrictions on
             data (large arrays, large stack, large data are OK).
        <P>
        <DT><CODE>large</CODE>
        <DD> No restrictions on code or data.
        <P>
    </DL>
    </BLOCKQUOTE>
    <P>

    The <CODE>small</CODE> memory model basically is a 32-bit
    programming model that uses the full 64-bit instruction
    set (which has more registers, and is in other ways more
    powerful than the 32-bit <CODE>x86</CODE> instruction set).
    It is the default for most (Intel, GNU, Portland Group) compilers.
    Since most programs don't use more than 2 GB of total memory,
    it is adequate for most environmental modeling needs.
    <P>

    The <CODE>medium</CODE> memory model is fully 64-bit for
    data, but 32-bit for the instruction-part of programs.
    Given enough RAM, it can handle virtually all environmental
    programming needs.  It is the default for Sun/Oracle's
    Linux compilers; for Intel, GNU, Portland Group compilers,
    you need to add the following option to the compile and
    link commands
    <BLOCKQUOTE><CODE>
    -mcmodel=medium
    </CODE></BLOCKQUOTE>
    <P>

    The <CODE>large</CODE> memory model is rarely needed (who
    writes models that compile into object files larger than
    2 GB, anyway??), and seems to be supported only by the Intel
    compilers, and the latest versions of the GNU compilers
    <EM>provided that the compiler itself is compiled with
    this option</EM>.
    You will need the following compile-option for it:
    <BLOCKQUOTE><CODE>
    -mcmodel=large
    </CODE></BLOCKQUOTE>
    <P>

    <STRONG>Note that program-codes (object files and libraries)
    compiled with the different memory models are binary-incompatible.
    All model-components need to be compiled with the same memory-model
    flags. </STRONG>. Binary types
    <CODE>${BIN}=Linux2_x86_64gfort_medium</CODE>,
    <CODE>Linux2_x86_64ifort_medium</CODE>, and
    <CODE>Linux2_x86_64pg_medium</CODE> are provided for
    medium-memory-model use with the Intel, GNU, or PGI compilers.  Note
    also that the Intel and PGI compilers do not support static linking
    for the medium (or large, for Intel) memory model.
    <P>

    See <A HREF="http://eli.thegreenplace.net/2012/01/03/understanding-the-x64-code-models">
    http://eli.thegreenplace.net/2012/01/03/understanding-the-x64-code-models</A>
    for a somewhat readable and very detailed account of the issues,
    and also
    <A HREF="https://software.intel.com/en-us/node/525162">
    https://software.intel.com/en-us/node/525162</A>
    <P>
    </BLOCKQUOTE>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!----------------------------------------------------------------->

    <H3><A NAME="large"><VAR>netCDF</VAR> and Large Files</A></H3>


    <BLOCKQUOTE>
    Starting with Version&nbsp;3.3.1, <VAR>netCDF</VAR> can be compiled
    with &quot;large file support&quot; for most 32-bit platforms (and
    for 64-bit platforms like Cray, IRIX64, Alpha, IA64, and x86_64).
    This suffices for most environmental modeling applications; the
    limitation is that (the totality of variables in) an individual time
    step may not exceed 4&nbsp;GBytes.  Starting with Version&nbsp;3.6,
    <VAR>netCDF</VAR> supports a new variant of the underlying data
    format, with essentially no (software based) limitations on file,
    record, or array size.  This format is not yet supported by older
    versions of the I/O&nbsp;API (partly because the old and new
    <VAR>netCDF</VAR> formats are not fully compatible); design analysis
    was in progress in 2005, and for I/O&nbsp;API versions 3.1 and
    later, large-file support is automatic for input files and can be
    turned on for output files by doing the following before running the
    relevant model (this is the default for I/O&nbsp;3.2):
    <BLOCKQUOTE><CODE>
    setenv IOAPI_OFFSET_64 YES
    </CODE></BLOCKQUOTE>
    See <A HREF="ENVIRONMENT.html">Standard I/O&nbsp;API environment variables</A>
    in the documentation.
    <P>

    For more information, see URL
    <A HREF="http://my.unidata.ucar.edu/content/software/netcdf/docs/netcdf/Large-File-Support.html#Large-File-Support">
    http://my.unidata.ucar.edu/content/software/netcdf/docs/netcdf/Large-File-Support.html#Large-File-Support</A>
    <P>
    </BLOCKQUOTE>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!----------------------------------------------------------------->

    <H3><A NAME="warn">Other Notes and Warnings</A></H3>

    <BLOCKQUOTE>
    <DL>
        <DT>  <STRONG>Strong Recommendation &nbsp;1</STRONG>
        <DD>  <EM>Don't change any I/O&nbsp;API <CODE>INCLUDE</CODE>
              files.</EM><BR>
              Any changes are likely to result in very obscure,
              difficult-to-diagnose bugs caused by an inconsistency
              between standard <VAR>libioapi.a</VAR> object-libraries
              and whatever code is compiled with the resulting modified
              <CODE>INCLUDE</CODE>-file. Note  that the distribution
              license specifies that by making any changes to any of
              these <CODE>INCLUDE</CODE> files, the user explicitly
              agrees that <STRONG>in the case any assistance is
              required of UNC CEMPD or of the I/O&nbsp;API author,
              Carlie&nbsp;J. Coats,&nbsp;Jr. as a result of such
              changes, the user and/or his project or contract agrees to
              reimburse UNC CEMPD and/or the I/O&nbsp;API author,
              Carlie&nbsp;J.&nbsp;Coats,&nbsp;Jr., at a rate triple the
              normal contract rate for the services required.</STRONG>
              <P>
        <DT>  <STRONG>Strong Recommendation &nbsp;2</STRONG>
        <DD>  You are best off if you can build the whole modeling
              system (<VAR>libnetcdf.a</VAR>, <VAR>libpvm3.a</VAR>,
              <VAR>libioapi.a</VAR>, and your model(s)  <VAR>CMAQ</VAR>,
              <VAR>SMOKE</VAR>, etc. with a common compiler set and
              common set of compile-flags.  In particular,
              Linux-distribution-vendor supplied <VAR>libnetcdf.a</VAR>
              rarely works with CMAS-supported compiler sets.
              <P>
        <DT>  <STRONG>Note&nbsp;3</STRONG>
        <DD>  For 64-bit platforms, it turns out that many compilers by
              default still only allow individual arrays and
              program-stack sizes smaller than 2&nbsp;GB.  For the vast
              majority of current modeling applications, this is not a
              problem.  <A HREF="#medium">This is documented in detail
              in a section above.</A>
              <BR>
              <STRONG>To use &quot;large&quot; arrays, i.e., larger than
              2&nbsp;GB, or very-deep recursion, you will need  to build
              your entire model (libraries and all) using compile flags
              that tell the compiler to use the &quot;medium
              64-bit&quot; memory model.</STRONG>  The I/O&nbsp;API
              <VAR>Makeinclude.Linux2_x86_64ifort_medium</VAR> (for
              <CODE>BIN=Linux2_x86_64ifort_medium</CODE>) has the flags
              you need in order to do this with Intel compilers.
              (Portland Group and Gnu compilers also default to
              &quot;small 64-bit&quot; memory model in the same way as
              Intel; Sun's Linux compilers default to medium 64-bit
              memory model.  For others, check your compiler
              documentation.)
              <P>
        <DT>  <STRONG>Note&nbsp;4</STRONG> (applicable for v3.0 and earlier only)
        <DD>  On at least Sun Solaris and SGI IRIX platforms, <VAR>f77</VAR>
              and <VAR>f90</VAR> are known not to be link compatible; you will
              need to keep builds for them separate (which is the original
              distinction for <CODE>BIN=IRIX64f77</CODE> vs
              <CODE>BIN=IRIX64f90</CODE>,
              for example).  It is recommended that for other systems you likewise
              keep different compiler systems (and sometimes even different
              versions of the same compiler--Intel <VAR>ifort</VAR> versions
              10, 11, and 12, for example) separate.
              <P>
    </DL>
    </BLOCKQUOTE>
    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!----------------------------------------------------------------->

<H3> <A NAME="v32">I/O&nbsp;API Version&nbsp;3.2 Availability</A></H3>

    <BLOCKQUOTE>
    <A HREF="NEWSTUFF.html#jan2015">NOTE, January 15, 2015:</A>
    Version&nbsp;3.2 of the I/O&nbsp;API library source code and
    documentation is available from GitHub from
    <A HREF="https://github.com/cjcoats/ioapi-3.2"><VAR>&lt;https://github.com/cjcoats/ioapi-3.2&gt;</VAR></A>.
    or for download in <VAR>tar-gzip</VAR>ped form  from the CMAS Center
    web site
    <A HREF ="https://www.cmascenter.org/ioapi/download/ioapi-3.2.tar.gz"><VAR>&lt;ioapi-3.2.tar.gz&gt;</VAR></A>.
    To install it from GitHub, go to the directory under which do the
    installation, and then do the command
    <PRE>
    git clone https://github.com/cjcoats/ioapi-3.2
    </PRE>
    <CODE>git clone...</CODE>  will create a directory
    <VAR>ioapi-3.2</VAR> with subdirectories  <VAR>ioapi</VAR>,
    <VAR>m3tools</VAR>, and <VAR>HTML</VAR>, and various other files,
    including the <VAR>LICENSE</VAR> and top-level <VAR>Makefile</VAR>;
    unpacking the <CODE>tar</CODE>-ball will create everything under
    that <VAR>ioapi-3.2</VAR> directory.
    <P>

    Due to <CODE>INTERFACE</CODE> changes in
    <CODE>MODULE&nbsp;M3UTILIO</CODE>, new
    <CODE>MODULE&nbsp;MODGCTP</CODE>, and new module
    <CODE>MODULE&nbsp;MODATTS3</CODE> (which replaces
    <CODE>MODULE&nbsp;MATXATTS</CODE>), there will be minor source-code
    changes in programs that use it; re-compilation and re-linking will
    be required:  see <A HREF="NEWSTUFF.html#ver32">here for more details.</A>
    <P>
    </BLOCKQUOTE>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!----------------------------------------------------------------->

<H3> <A NAME="v31">I/O&nbsp;API Version&nbsp;3.1 Availability</A></H3>

    <BLOCKQUOTE>
    Version&nbsp;3.1 of the I/O&nbsp;API library source code is
    <A HREF ="https://www.cmascenter.org/ioapi/download/ioapi-3.1.tar.gz">available here
    for download</A> in <VAR>tar-gzip</VAR>ped  form. This version is
    upwardly source-code compatible with previous versions; however, it
    is <EM>not</EM> object-code compatible, nor is it compatible with
    object files built using <CODE>INCLUDE</CODE> files derived from
    previous versions.  New features of this release are
    <A HREF = "NEWSTUFF.html#aug1010">documented here</A>, and include
    <UL>
        <LI>  Change of <CODE>MXVARS3</CODE> in <VAR>PARMS3.EXT</VAR>
              from 120 to 2048.  Consultation with actual modelers
              indicate that this should be more than adequate;
              suggestions elsewhere that users should change
              <CODE>MXVARS3</CODE> to 50000 are extremely irresponsible,
              quite ridiculous, and dangerous for all but the most
              sophisticated users..
        <LI>  removal of <VAR>f77</VAR> support
        <LI>  optional support for &quot;large&quot;time-step records
              (total timestep extent, including all variables, exceeds
              2GB), controlled by environment variable
              <CODE>IOAPI_OFFSET_64</CODE> (default <CODE>NO</CODE>)
        <LI>  Fortran-90-ized <VAR>m3tools</VAR> programs
              (demonstrating how <CODE>MODULE&nbsp;M3UTILIO</CODE>
              should be used for all new codes).
        <LI>  Changes to <VAR>Makeinclude</VAR> files for
              <VAR>gfortran</VAR>, together with replacing
              <VAR>g77</VAR> with that compiler for some
              <CODE>${BIN}</CODE> choices.
        <LI>  Minor changes to <CODE>MODULE&nbsp;M3UTILIO</CODE>:
              <UL>
                  <LI>  Specification of <CODE>INTENT</CODE> where possible
                        in the <CODE>INTERFACE</CODE>s
                  <LI>  Add <CODE>INTERFACE</CODE>s for <CODE>JUNIT()</CODE>.
                        <CODE>PCOEF()</CODE>, <CODE>PROMPTGRID()</CODE>,
                        <CODE>SCANINT()</CODE>, <CODE>SETSPHERE()</CODE>,
                        <CODE>INITSPHERES()</CODE>, <CODE>SPHEREDAT()</CODE>,
                        <CODE>SKIPL()</CODE>.
                  <LI>  New routine  <CODE>LASTTIME()</CODE> does
                        overflow-safe computation of the ending
                        date&amp;time <CODE>EDATE,ETIME</CODE> for a
                        timestep sequence with starting date&amp;time
                        <CODE>SDATE,STIME</CODE>, timestep <CODE>TSTEP</CODE> and
                        <CODE>NRECS</CODE> steps.
              </UL>
        <LI>  Default <VAR>m3tools</VAR> <CODE>Makefile</CODE>s
              assume netCDF 4.1 or later (which requires
              <CODE>-lnetcdff</CODE> as part of the library flags
              for linking).
        <LI>  Various other changes&mdash;mostly bug-fixes&mdash;since
              March&nbsp;15, 2010.  These are documented on the
              <A HREF="NEWSTUFF.html">&quot;What's New&quot; page</A>.
              Notable are
              <UL>
                  <LI>  New <VAR>m3tools</VAR> programs
                        <UL>
                        <LI> <A HREF = "GREG2JUL.html" ><CODE>greg2jul</CODE></A>
                        <LI> <A HREF = "JUL2GREG.html" ><CODE>jul2greg</CODE></A>
                        <LI> <A HREF = "JULDIFF.html"  ><CODE>juldiff</CODE></A>
                        <LI> <A HREF = "JULSHIFT.html" ><CODE>julshift</CODE></A>
                        <LI> <A HREF = "TIMESHIFT.html"><CODE>timeshift</CODE></A>
                        </UL>
                  <LI>  Generic <CODE>INTERFACE</CODE>s
                        <CODE>ENVLIST</CODE>, <CODE>FINDKEY</CODE>,
                        <CODE>LOCATE</CODE>, and <CODE>SORTI</CODE>
                        in <CODE>MODULE M3UTILIO</CODE>
                  <LI>  Hacks for supporting various versions of
                        <VAR>gfortran</VAR>
                  <LI>  OpenMP parallel for programs <CODE>M3AGMASK,
                        M3AGMAX, M3COMBO, M3TPROC</CODE>
                  <LI>  New <CODE>SUBROUTINE LASTTIME</CODE> and
                        changes in other timestep related routines
                        for safew multi-decade/multi-century support.
                  <LI>  Support for netCDF versions&nbsp;4.x
              </UL>
    </UL>
    <P>
    The build procedure is <STRONG><A HREF="#build">given above.</A></STRONG>.
    <P>

    Version&nbsp;3.1 can read all files generated by Versions&nbsp;3.0
    and earlier; Version&nbsp;3.0 can read all files generated by
    Version&nbsp;3.1, provided that the number if variables in the file
    <CODE>NVARS3D&nbsp;&lt;&nbsp;121</CODE>.
    <P>

    Due to the changes in <CODE>MXVARS3</CODE>. Version&nbsp;3.1 is a
    &quot;Jubilee Day&quot; release:  it should completely replace
    previous versions; <STRONG>object and library files produced using
    Version&nbsp;3.1 should not be mixed with previous versions.
    <P>

    </STRONG>
    Note that proper use of <CODE>MODULE&nbsp;M3UTILIO</CODE>
    ensures that the library and user object code use consistent
    parameter values (as well as ensuring correctness of most
    call interfaces).
    <P>
    Note also that changing  <CODE>MXVARS3</CODE> was <EM>never</EM>
    supported, is strongly discouraged, and <EM>may lead to invocation
    of the triple-time clause</EM> (see header of <VAR>PARMS3.EXT</VAR>)
    if support of such a modified installation is requested.
    <P>

    This release is current as of October&nbsp;1, 2015 and includes all
    bug-fixes up through that date.
    <P>
    </BLOCKQUOTE>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>

<HR> <!----------------------------------------------------------------->

<H3> <A NAME="v30">I/O&nbsp;API Version&nbsp;3.0 Availability</A></H3>

    <BLOCKQUOTE>
    <STRONG>Version&nbsp;3.0 (or earlier) of the I/O&nbsp;API library
    source code should be considered obsolete, and used only if
    necessary.</STRONG>
    <P>

    Version&nbsp;3.0 of the I/O&nbsp;API library source code is
    <A HREF="https://www.cmascenter.org/ioapi/download/ioapi-3.0.tar.gz">available
    here for download</A> in <VAR>tar-gzip</VAR>ped  form. New features
    of this release are <A HREF = "NEWSTUFF.html#may17">documented
    here</A>, and include additional support for WRF, a new
    native-binary-format lower layer, a file-set lower layer, some new
    routines, and enhancements for portability and OpenMP thread-safety.
    <P>
    This release is current as of June&nbsp;11, 2007 and includes all
    bug-fixes up through that date.  <STRONG>It should be considered
    the production release of Version&nbsp;3.0 for netCDF files and for
    PVM-based virtual files</STRONG>, but should probably still be
    considered &quot;beta&quot; for native-binary layer, and for the
    multi-file file-list layer, since each of these latter has
    basically a single-user community rather than widespread beta-test
    usage.
    <P>
    The build procedure also has been considerably enhanced, by the addition
    of a top-level  <VAR>Makefile</VAR> which allows one to build
    various configurations of the entire (<VAR>I/O&nbsp;API +
    <CODE>M3TOOLS</CODE></VAR>) system with one <VAR>make</VAR> command.
    Depending upon what you want to do, there are two main options for
    how you will build the system:
    <DL>
        <DT>  <STRONG>To build multiple configurations</STRONG> from
              one installation directory (e.g., multiple compilers,
              etc.)
        <DD>  The procedure is much as before, except that one can
              use just a single <VAR>make&nbsp;bins</VAR> command to build all
              the libraries and all the executables for a configuration.
              <P>
              Before you do so, yhou should edit the <VAR>ioapi/Makefile</VAR>
              and  <VAR>m3tools/Makefile</VAR> commands so that the
              <VAR>make&nbsp;bins</VAR> and <VAR>make&nbsp;binclean</VAR>
              commands properly reflect the configurations you want to build.
              <P>
        <P>
        <DT>  <STRONG>To build a single configuration</STRONG> from
              one installation directory
        <DD>  Follow the <STRONG><A HREF="#build">build procedure given above.</A></STRONG>.
        <P>
        <DT>  <STRONG>To set up the installation:</STRONG>
        <DD>  <OL>
                  <LI> Download the <EM>gzip</EM>ped tar-file. It contains
                       directories <CODE>ioapi</CODE> for the
                       I/O&nbsp;API library source code,
                       <CODE>HTML</CODE> for the documentation,
                       <CODE>m3tools</CODE> for the related tool
                       programs, <CODE>iotest</CODE> for various
                       test-programs, and <CODE>notcdf</CODE> for the
                       NCEP <VAR>libnotcdf.a</VAR> library (a dummy library
                       for installation sites that don't
                       allow <VAR>netCDF</VAR> on-site).
                  <P>
                  <LI> <EM>cd</EM> to the directory under which you wish
                       to build the I/O&nbsp;API. <EM>gunzip</EM> and
                       untar (<VAR>gtar&nbsp;xvfz&nbsp;ioapi-3.0.tar.gz</VAR>
                       does this in one operation).
                  <P>
                  <LI> If you want to disable the <A HREF="BUFFERED.html#pvm">coupling-mode
                        </A> configuration (which is enabled by default),
                        <EM>cd&nbsp;ioapi</EM>  and then
                        <EM>cp&nbsp;Makefile.nocpl&nbsp;Makefile</EM>.
                 <P>
                  <LI>  For each desired configuration,
                        <VAR>setenv&nbsp;BIN&nbsp;&lt;machinetype&gt;</VAR>,
                        where <CODE>&lt;machinetype&gt;</CODE> matches
                        the extension on one of the
                        <CODE>ioapi/Makeinclude.*</CODE>.  Then do a
                        top-level <VAR>make&nbsp;dirs</VAR> to build the
                        object-directories.
                        <P>
                        The usual pattern for generating <CODE>BIN</CODE> is
              <BLOCKQUOTE>
              <VAR>setenv BIN  `uname -s``uname -r | cut -d. -f1`</VAR>
              </BLOCKQUOTE>
                        and then modify the result by appending any
                        compiler specifics, e.g., for F90 or debug
                        compiled configurations.
                        <P>
                        Note,  for example,
                        that for <CODE>Linux2_x86</CODE>, there are
                        distinct (and incompatible) variants for the
                        GNU <VAR>g77/gcc</VAR>, Intel <VAR>ifc/icc</VAR>,
                        Lahey-Fujitsu <VAR>lf95</VAR>/GNU <VAR>gcc</VAR>,
                        and Portland Group <VAR>pgf90/pgcc</VAR>;
                        <STRONG>moreover, the latter is not compatible with
                        Portland Group <VAR>pgf90</VAR>/GNU
                        <VAR>gcc</VAR> (when the latter is used to
                        build <VAR>libnetcdf.a</VAR>, as in the vendor
                        supplied libraries on RedHat</STRONG> <EM>(that
                        incompatibility being the largest single
                        generator of installation-questions in recent
                        years!).</EM>
                        <P>
                        <EM><STRONG>INTEL and SGI NOTES:</STRONG>
                         <UL>
                           <LI> At some point in its 8.0.x sequence of
                                compiler versions, Intel has changed the
                                names of its compilers:  <VAR>ecc</VAR>
                                becomes <VAR>icc</VAR> for the Itanium (IA64)
                                platform, and both   <VAR>efc</VAR> and
                                <VAR>ifc</VAR> become <VAR>ifort</VAR>; you
                                may need to edit the
                                <CODE>MAKEINCLUDE.$BIN</CODE>
                                accordingly.
                           <LI> There are problems with the Fortran
                                pre-processing for some versions of the
                                Intel Fortran compilers;  these can to
                                some extent alleviated by separating
                                the preprocessing from the compile step
                                for the <CODE>*.F</CODE> files.
                                <VAR>Makefile.cpphack</VAR> is a sample
                                <VAR>Makefile</VAR> for this purpose
                                (as provided, it assumes OpenMP and
                                coupling mode).
                           <LI> There are problems with SGI
                                <VAR>f90</VAR> Version&nbsp;7.4.  Use
                                Version&nbsp;7.4.1 or later instead.
                           <LI> There are command line incompatibilities
                                between SGI <VAR>f90</VAR> Version&nbsp;7.3.x
                                and 7.4.1; for 7.3.x, you need to edit the
                                <CODE>MAKEINCLUDE.$BIN</CODE> to replace
                                <CODE>-TARG:platform=ip27 -TARG:processor=r12000</CODE>
                                by <CODE>-TARG:platform=ip27,processor=r12000</CODE>,
                                (etc.)
                        </UL>
                        </EM>

                  <P>
                  <LI>  Acquire and build the netCDF library,
                        <VAR>libnetcdf.a</VAR>, for each configuration.
                        The netCDF home page is
                        <A HREF="https://www.unidata.ucar.edu/software/netcdf/">
                        https://www.unidata.ucar.edu/software/netcdf/</A>
                        For each configuration,copy or link the resulting
                        <VAR>libnetcdf.a</VAR> ( and <VAR>libnetcdff.a</VAR>,
                        if you're building netCDF version 4.1 or later)
                        to the appropriate object
                        directory.
                        <P>
                        If you plan to build a
                        <A HREF="BUFFERED.html#pvm">coupling-mode
                        configuration</A>, do the same with PVM's
                        <VAR>libpvm3.a</VAR>. See
                        <A HREF="http://www.csm.ornl.gov/pvm/pvm_home.html">
                        http://www.csm.ornl.gov/pvm/pvm_home.html</A>
                        (Only the C interface to PVM is used; the resulting
                        library tends to be more compiler-independent than
                        for netCDF, where both C and Fortran interfaces
                        are used.)
                  <P>
                  <LI>  Edit the relevant files
                        <CODE>ioapi/Makeinclude.$BIN</CODE> for your
                        system specific compiler options and PVM
                        installation location, as appropriate.
                  <P>
                  <LI>  Edit the top-level <CODE>Makefile</CODE> to set
                        variables <CODE>BASEDIR</CODE>, etc., for your
                        system.
                        <P>
                        If you are doing a multi-configuration
                        installation, do the same for each
                        <CODE>*/Makefile*</CODE>.
                        <P>
                        If you are doing a single-configuration
                        installation, do <VAR>make&nbsp;configure</VAR>
                  <P>
                  <LI>  <VAR>setenv&nbsp;BIN&nbsp;...</VAR>, followed by
                        one of the <VAR>make&nbsp;&lt;target&gt;</VAR>
                        commands below,  as appropriate for your
                        configuration(s),
                  <P>
                  <LI>  Note that a top-level <VAR>make</VAR> will
                        generate messages about installing the
                        <VAR>notCDF</VAR> library.  Almost all users
                        can ignore these messages;
                        <VAR>libnotcdf.a</VAR> is only required at NCEP,
                        where it is politically forbidden to have any
                        copy of <VAR>libnetcdf.a</VAR> on the system.
              </OL>
        <P>
    </DL>
    <P>
    </BLOCKQUOTE>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>

<HR> <!----------------------------------------------------------------->

<H3> <A NAME="v22">I/O&nbsp;API Version&nbsp;2.2 Availability</A></H3>

    <STRONG>Version&nbsp;2.2 (and all older versions) of the
    I/O&nbsp;API library source code should be considered
    obsolete.</STRONG>
    <P>

    <BLOCKQUOTE>
    Version&nbsp;2.2 of the I/O&nbsp;API library source code is
    <A HREF = "https://www.cmascenter.org/ioapi/download/ioapi_22.tar.gz">available
    here for download</A> in <VAR>tar-gzip</VAR>ped form. New features
    of this release are <A HREF = "NEWSTUFF.html"> documented here</A>.
    The build procedure is the same as that for Version&nbsp;2.1,
    documented below, except for the following:
    <UL>
        <LI>  The default object library directory is directly
              <EM>under</EM> the source code directory.  To change
              where the object directory is located, change the value
              of shell variable <CODE>OBJDIR</CODE> in the
              <CODE>Makefile</CODE>, either by commenting out the
              current value and un-commenting one of the alternatives,
              or by setting your own system-dependent value.
              <P>
        <LI>  The default <CODE>Makefile</CODE> builds the I/O&nbsp;API
              with the <VAR><A HREF="BUFFERED.html#pvm">Coupling Mode
              Extensions</A></VAR> enabled, and therefore requires
              linking executables with PVM library (version&nbsp;3 or
              greater).  To disable the <VAR>Coupling Mode
              Extensions,</VAR> copy the provided
              <CODE>Makefile.nocpl</CODE> to <CODE>Makefile</CODE> and
              then build the system.
              <P>
    </UL>
    <P>
    <EM>This download is current as of October&nbsp;18,&nbsp;2003</EM>
    </BLOCKQUOTE>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>

<HR> <!----------------------------------------------------------------->

<H3> <A NAME="v21">I/O&nbsp;API Version&nbsp;2.0 and 2.1 Availability</A></H3>

    <BLOCKQUOTE>
    <EM>Updated May&nbsp;7,2002 for SMOKE release:  now produces a
    library named <CODE>libioapi_v2.1.a</CODE> instead of
    Version&nbsp;2.0's <CODE>libioapi_new.a</CODE></EM>
    <P>
    Source code for Release Version 2.1 of the I/O&nbsp;API  and the
    I/O&nbsp;-related tool and sample programs is
    <A HREF = "https://www.cmascenter.org/ioapi/download/ioapi_21.tar.gz">available
    here for download</A> in
    <VAR>tar-gzip</VAR>ped form.  New features of this release are
    <A HREF = "NEWSTUFF.html">documented here</A>. <CODE>Makeinclude</CODE>
    files are available for the following platforms (and some debug- and
    other variants, denoted by <CODE>dbg</CODE> <CODE>i8</CODE>, and
    <CODE>r8</CODE> suffixes):
    <UL>
        <LI>  AIX (32-bit, with default name-mangling rules)
        <LI>  AIX_ (32-bit, with Feldmanish name-mangling rules)
        <LI>  HP-UX  using <VAR>f90</VAR>
        <LI>  IRIX5 &quot;old-32&quot; binary object-format,
              using <VAR>f77</VAR>
        <LI>  IRIX5f90 &quot;old-32&quot; binary object-format,
              using <VAR>f90</VAR>
        <LI>  IRIX6 (same as IRIX6n32)
        <LI>  IRIX64 &quot;-64&quot; binary type, using <VAR>f77</VAR>
        <LI>  IRIX64f90 &quot;-64&quot; binary type, using <VAR>f90</VAR>
        <LI>  IRIX6n32  &quot;-n32&quot; binary type
        <LI>  IRIX6n32f90  &quot;-n32&quot; binary type, using
              <VAR>f90</VAR>
        <LI>  IRIX6n32f90dbg  &quot;-n32&quot; binary type, using
              <VAR>f90</VAR>, compiled for debug
        <LI>  Linux2_alpha using GNU <VAR>gcc</VAR> and Compaq <VAR>fort</VAR>
        <LI>  Linux2_ia64 using <VAR>gcc</VAR> and <VAR>g77</VAR>
        <LI>  Linux2_ia64eifc using the
              <A HREF="http://www.intel.com/software/products/">
              Intel</A> <VAR>efc</VAR> and <VAR>ecc</VAR>
        <LI>  Linux2_x86 using <VAR>gcc</VAR> and <VAR>g77</VAR>
        <LI>  Linux2_x86ifc using the
              <A HREF="http://www.intel.com/software/products/">
              Intel</A> <VAR>ifc</VAR> and <VAR>icc</VAR>
        <LI>  Linux2_x86lf95 using the <A HREF="http://www.lahey.com/">
              Lahey-Fujitsu</A> <VAR>f95</VAR> and GNU <VAR>gcc</VAR>
        <LI>  Linux2_x86pg using the <A HREF="http://www.pgroup.com/">
              Portland Group</A> <VAR>f90</VAR> and <VAR>cc</VAR>
              <BR>
              <EM>NOTE: <CODE>Makeinclude.Linux2_x86pg</CODE> assumes
              you are using a <CODE>gcc/g77</CODE>-compatible
              <CODE>libnetcdf.a</CODE> (as comes from the vendor on
              many Linux systems).  For <CODE>pgf77/pgf90/pgcc</CODE>
              versions of <CODE>libnetcdf.a</CODE>, remove
               <CODE>-Msecond_underscore</CODE> from
               <CODE>ARCHFLAGS</CODE> in
               <CODE>Makeinclude.Linux2_x86pg</CODE>. </EM>
        <LI>  Alpha OSF1 using Compaq <VAR>f90</VAR> and <VAR>cc</VAR>
        <LI>  SunOS5    using <VAR>f77</VAR>
        <LI>  SunOS5f90 using <VAR>f90</VAR>
        <LI>  cray UNICOS10/F90
    </UL>
    <P>

    From these examples and from a knowledge of the compiler user manual,
    it should be relatively easy to build <CODE>Makeinclude</CODE> files
    for most UNIX or UNIX-like platforms and compilers.  Instructions
    for building the I/O&nbsp;API library <CODE>libioapi_v2.1.a</CODE>
    and the I/O&nbsp;API tool executable programs are as given below.
    <P>
    <EM><STRONG>NOTE:</STRONG> It is important to ensure that the compile
    flags used for building the I/O&nbsp;API library are consistent with
    both the compile flags used for building your program and the
    compile flags used for building the netCDF, PVM, and other libraries
    used by your programs.  Failure to do so may result in link-failures
    or (in the case of the Linux Portland Group compilers) run-time
    program deadlocks (program hangs, doing no work while consuming all
    available CPU resources).</EM>
      <OL>
        <LI>  Download the gzipped tar-file <CODE>ioapi_21.tar.gz</CODE>.
              It contains directories <CODE>ioapi</CODE> for the
              I/O&nbsp;API library source code, <CODE>ioapi_doc</CODE>
              for the HTML documentation, and <CODE>ioapi_tools</CODE>
              for the related tool programs.
              <P>
        <LI>  <EM>cd</EM> to the directory under which you wish to build
              the I/O&nbsp;API. <EM>gunzip</EM> and untar the
              <CODE>ioapi_21.tar.gz</CODE> (with Gnu <EM>tar</EM>,
              <BLOCKQUOTE><CODE>tar xvfz ioapi_v2.1.tar.gz</CODE></BLOCKQUOTE>
              does unzip-untar all in one step).
              <P>
        <LI>  <CODE>setenv BIN &lt;machinetype&gt;</CODE><BR>
              where <CODE>&lt;machinetype&gt;</CODE> matches the
              extension on one of the <CODE>Makeinclude.*</CODE>
              (building your own <CODE>Makeinclude</CODE> if yours
              is not one of the supported systems).<BR>
              <EM>
              The usual pattern for generating <CODE>BIN</CODE> is
              <BLOCKQUOTE>
              <CODE>setenv BIN  `uname -s``uname -r | cut -d.
              -f1`</CODE>
              </BLOCKQUOTE>
              although there are exceptions where more work is needed
              for Cray, SGI and Linux systems, and F90 or DEBUG
              compiles.
              </EM>
              <P>
        <LI>  The default directory for both executables and object
              libraries is in directory <CODE>../$BIN</CODE> relative
              to the source code directories for the I/O&nbsp;API and
              tools. Edit the Makefile to put OBJDIR wherever you want it
              (if you want somewhere other than the default
              <CODE>../$BIN</CODE> location).
              <BR><EM>
              <STRONG>NOTE 1:</STRONG>  Different compilers generate
              linker-visible object names in different ways (some with
              multiple options...).  It is important that all of the
              compiles for an entire executable program (including the
              compiles for netCDF, PVM, and other libraries) use the
              same scheme; this is controlled by various parts of the
              <CODE>ARCHFLAGS</CODE> variable in the (compiler-system
              dependent) <CODE>Makeinclude.$BIN</CODE> files.
              <BR>
              <STRONG>NOTE 2:</STRONG>  By default on most systems,
              OpenMP parallelism is enabled; see the <CODE>OMPFLAGS</CODE>
              variable in <CODE>Makeinclude.$BIN</CODE>.  The
              I/O&nbsp;API does not have parallel sections of its own;
              however, enabling OpenMP does allow the activation of
              critical sections allowing the I/O&nbsp;API to be
              thread-safe for OpenMP-parallel programs (like the
              MAQSIP-RT air quality model, the WRF or MCPL-enabled MM5
              meteorology models, research versions of SMOKE, and others.
              You may set <CODE>OMPFLAGS</CODE> and <CODE>OMPLIBS</CODE>
              to empty-strings in order to disable this
              thread-protection, if you wish.
              </EM>
              <P>
        <LI>  In the I/O&nbsp;API library source directory <CODE>ioapi</CODE>,
              type <EM>make</EM> to build the object library.  The
              current build process will generate
              <CODE>$OBJDIR/libioapi_v2.1.a</CODE> (to distinguish it
              from earlier Version 1 <CODE>$OBJDIR/libioapi.a</CODE>);
              <EM>mv</EM> it to <CODE>libioapi.a</CODE> or
              <CODE>libm3io.a</CODE>, if desired.
              <P>
        <LI>  If necessary, get netCDF and build
              <CODE>libnetcdf.a</CODE>; if you're building with Coupling
              Mode active, do the same for PVM.
        <LI>  Copy or link  (<VAR>ln -s ...</VAR>) <CODE>libnetcdf.a</CODE>
              (and <CODE>libpvm3.a</CODE> if you built it) to your
              <CODE>OBJDIR</CODE>.
              <P>
        <LI>  In the I/O&nbsp;API tool source directory
              <CODE>ioapi_tools</CODE>, type either <CODE>make</CODE>
              (if you have a F90-compliant Fortran compiler), or
              <CODE>make&nbsp;f77</CODE> (if you don't) to build the
              tool-program executables (adjusting the <CODE>LIB</CODE>
              <EM>make</EM>-variable if you renamed
              <CODE>$OBJDIR/libioapi_v2.1.a</CODE> in the preceeding
              step).  Note that there are a number of these programs
              that <EM>do</EM> require F90:  <CODE>dayagg, ginterp,
              m3cple, m3agmax, m3agmask, m3combo, m3merge, mtxblend,
              mtxbuild, mtxcalc, mtxcple, presterp,</CODE> and
              <CODE>selmrg2d</CODE>.
              <P>
    </OL>
    Binary executables and object libraries are no longer available
    (June 11, 2012 ).
    <P>
    <STRONG>NOTE: </STRONG> On the Sun SunOS and SGI IRIX platforms,
    there are  <STRONG><EM>link incompatibilities between f77 and
    f90</EM></STRONG>, caused by the fact that these vendors'
    <EM>f77</EM> and <EM>f90</EM> by default use different system
    libraries.  Compaq, Cray, and IBM compilers do not seem to do this;
    however, it is probably advisable not to mix  <EM>f77</EM> and
    <EM>f90</EM> compiles on a not-well-understood new platform.
    <P>
    </BLOCKQUOTE>


    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!----------------------------------------------------------------->

    <H3><A NAME="note">NOTE on File Types</A></H3>

    <BLOCKQUOTE>
    Files with extension &quot;.gz&quot; or &quot;.tgz&quot; are
    compressed with the GNU <VAR>gzip</VAR> utility.  Source for
    <VAR>gzip</VAR> is available from
    <A HREF = "http://www.gnu.org/order/ftp.html">a number of FTP
    sites</A>; executables for a variety of platforms are available
    from several sources, including
    <A HREF = "ftp://ftp.netscape.com/pub/unsupported/gnu/">
    ftp://ftp.netscape.com/pub/unsupported/gnu/</A>.  On windows
    platforms, either <A HREF = "http://www.winzip.com">winzip</A>
    or the <A HREF = "http://www.cygnus.com">Cygnus</A> windows port
    of <VAR>gzip</VAR> can deal  with &quot;.gz&quot; and
    &quot;.tgz&quot; files.
    <P>

    The &quot;industry standard&quot; for Fortran source-file naming is
    that the extensions for file names should be as follows:
    <UL>
        <LI><CODE>.f</CODE> for fixed format Fortran source code
        <LI><CODE>.f90</CODE> for free format Fortran source code
        <LI><CODE>.F</CODE> for fixed format Fortran source code that
            needs to be run through the C pre-processor <VAR>cpp</VAR>
            before compiling (because it uses <CODE>#include</CODE>,
        <CODE>#define</CODE> and that sort of thing)
        <LI><CODE>.F90</CODE> for free format Fortran source code that
            needs to be run through the C pre-processor <VAR>cpp</VAR>
    </UL>
    Virtually all UNIX/Linux Fortran compilers will automatically use
    the file-extension to determine which source form to expect, unless
    you override this expectation with explicit flags specifying
    otherwise.  Sadly, what these flags are varies from compiler to
    compiler.
    <P>
    The <VAR>findent</VAR> program is an excellent resource for
    converting code back and forth between the two forms (and even the
    non-Standard one); see 
    <A HREF="https://sourceforge.net/projects/findent/">
    https://sourceforge.net/projects/findent/</A>.
    <P>

    It is also much more convenient for <VAR>make</VAR> dependencies if
    Fortran <CODE>MODULE</CODE>s are one per file, with file name the
    lower case of the  <CODE>MODULE</CODE> name&mdash;
    <CODE>MODULE&nbsp;MODFOO</CODE> should be in the file named
    <VAR>modfoo.f</VAR> or  <VAR>modfoo.f90</VAR>, as appropriate
    (depending upon source-form).
    <P>
    </BLOCKQUOTE>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>

<HR> <!----------------------------------------------------------------->


    <H3><A NAME="disc">DISCLAIMER</A></H3>

    <BLOCKQUOTE>
    This source code and these object libraries are available in
    unsupported form only, and neither MCNC nor Baron Advanced
    Meteorological Systems LLC  accepts any liability for its
    usability or correctness for any purpose.  See the
    <A HREF="NOTICES.html">&quot;Notices&quot;</A> document
    for acknowledgements, copyright and licensing information.
    <P>

    On the other hand, its <A HREF = "mailto:carlie@jyarborough.com">author</A>
    thinks it is  <STRONG>good stuff<SUP>TM</SUP></STRONG> and welcomes
    comments and suggestions.
    </BLOCKQUOTE>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>

<HR> <!----------------------------------------------------------------->

<H3> <A NAME="docs">I/O&nbsp;API Documents</A></H3>

    <BLOCKQUOTE>
    Documentation for the EDSS/Models-3/BAMS I/O&nbsp;API is
    available only as HTML -- it was designed from the start as a
    heavily cross-linked hyperdocument, and <STRONG>is not available in
    linear dead-tree document-forms such as  PDF.</STRONG> The
    Documentation for the EDSS/Models-3 I/O&nbsp;API is copyright
    &copy; 1992-2002 MCNC, &copy; 1995-2017 Carlie J.&nbsp;Coats Jr,
    &copy; 2003-2011 Baron Advanced Meteorological Systems, and
    &copy; 2014-2017 UNC Institute for the Environment.
    <P>
    A <VAR>gzip</VAR>ped
    <VAR>tar</VAR>-file snapshot for I/O&nbsp;API Version&nbsp;2.1
    and its documentation is
    <A HREF = "https://www.cmascenter.org/ioapi/download/ioapi-2.1.tar.gz">available here.</A>;
    <P>
    </BLOCKQUOTE>

    Back to <STRONG><EM><A HREF = "#contents">Contents</A></EM></STRONG>
    <P>


<HR> <!----------------------------------------------------------------->

<STRONG><A HREF = "index.html">
UP:  I/O&nbsp;API home page
<P>
</A></STRONG>

Back to the <STRONG><EM><A HREF = "AA.html">
I/O&nbsp;API User Manual</A></EM></STRONG>
<P>

Send comments to
<A HREF = "mailto:carlie@jyarborough.com"> <ADDRESS>
          Carlie J. Coats, Jr. <br>
          carlie@jyarborough.com  </ADDRESS> </A><P>

<!--#include virtual="/INCLUDES/footer.html" -->
    <PRE>
    $Id: AVAIL.html 138 2019-10-29 21:20:00Z coats $
    </PRE>
</BODY>      <!--end body  -->
</HTML>      <!--end html  -->

